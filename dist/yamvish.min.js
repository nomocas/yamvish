!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.y=t()}}(function(){var t;return function e(t,n,r){function i(s,u){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return i(n?n:e)},c,c.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){var r=t("./lib/utils"),i=function(t){return new i.Template(t)};i.isServer=r.isServer,i.utils=r,i.Context=t("./lib/context"),i.Template=t("./lib/template"),i.PureNode=t("./lib/pure-node"),i.Virtual=t("./lib/virtual"),i.Container=t("./lib/container"),i.View=t("./lib/view");var o=t("./lib/interpolable");i.interpolable=o.interpolable,i.Interpolable=o.Interpolable,i.elenpi=t("elenpi"),i.dom=t("./lib/parsers/dom-to-template"),i.html=t("./lib/parsers/html-to-template"),i.expression=t("./lib/parsers/expression");var s=t("./plugins/router");for(var u in s)i[u]=s[u];i.c3po=t("./plugins/c3po-bridge"),i.rql=t("./plugins/rql"),i.aright=t("./plugins/validation"),i.mainContext=null,i.components={},i.addComponent=function(t,e){i.components[t]=e},e.exports=i},{"./lib/container":2,"./lib/context":3,"./lib/interpolable":6,"./lib/parsers/dom-to-template":7,"./lib/parsers/expression":8,"./lib/parsers/html-to-template":10,"./lib/pure-node":11,"./lib/template":12,"./lib/utils":13,"./lib/view":14,"./lib/virtual":15,"./plugins/c3po-bridge":23,"./plugins/router":24,"./plugins/rql":25,"./plugins/validation":26,elenpi:18}],2:[function(t,e,n){function r(t){t=t||{},this.__yContainer__=!0,this.parent=t.parent,this.childNodes=[],this.promises=[],o.call(this,t)}var i=t("./utils"),o=t("./pure-node"),s=t("./emitter");r.prototype={mount:function(t,e,n){if(this.destroyed)throw new Error("yamvish container has been destroyed. could not mount anymore.");if(t&&(t===this.mountPoint||t===this.mountSelector))return this;if(!this.childNodes)return this;var r=t;if("string"==typeof r&&(this.mountSelector=t,r=(n||i.domQuery)(t)),!r)throw new Error("yamvish : mount point not found : "+t);return this.mountPoint=r,e||i.emptyNode(r),i.mountChildren(this,r),(r._yamvish_containers=r._yamvish_containers||[]).push(this),this.dispatchEvent("mounted",this)},appendTo:function(t,e){return this.mount(t,"append",e)},unmount:function(){if(!this.mountPoint)return this;for(var t=0;t<this.childNodes.length;t++)this.mountPoint.removeChild(this.childNodes[t]);return this.mountPoint=null,this.mountSelector=null,this.dispatchEvent("unmounted",this)},destroy:function(){if(this.destroyed)return this;if(this.dispatchEvent("destroy",this),this.destroyed=!0,this.childNodes)for(var t=0;t<this.childNodes.length;t++)i.destroyElement(this.childNodes[t],!0);this.childNodes=void 0,this.context=void 0,this.mountPoint=void 0,this.mountSelector=void 0},then:function(t,e){return this.promises.length?(this.promise=Promise.all(this.promises),this.promises=[],this.promise.then(t,e)):this.promise?this.promise.then(t,e):Promise.resolve([]).then(t,e)},"catch":function(t){return this.promises.length?(this.promise=Promise.all(this.promises),this.promises=[],this.promise["catch"](t)):this.promise?this.promise["catch"](t):Promise.resolve([])}},i.mergeProto(o.prototype,r.prototype),i.mergeProto(s.prototype,r.prototype),r.prototype.appendChild=function(t){return o.prototype.appendChild.call(this,t),this.mountPoint&&this.mountPoint.appendChild(t),t},r.prototype.removeChild=function(t){return this.childNodes?(o.prototype.removeChild.call(this,t),this.mountPoint&&this.mountPoint.removeChild(t),t):!1},e.exports=r},{"./emitter":4,"./pure-node":11,"./utils":13}],3:[function(t,e,n){function r(t){t=t||{},this.data=void 0!==t.data?t.data:{},this.parent=t.parent,this.handlers=t.handlers||{},this.map={},this.path=t.path;var e=this;this._binds=[],t.path&&this.parent&&this._binds.push(this.parent.subscribe(t.path,function(t,n,r){e.reset(r)}))}function i(t,e,n,r,i){for(var o=0,s=t._upstreams.length;s>o;++o)t._upstreams[o](e,n,r,i)}var o=t("./utils");r.prototype={destroy:function(){this._binds&&this._binds.forEach(function(t){t()}),this._binds=null,this.parent=null,this.data=null,this.handlers=null,this.map=null},reset:function(t){return this.data=t||{},this.notifyAll("reset",null,this.map,t,"*"),this},toggle:function(t){return this.set(t,!this.get(t)),this},set:function(t,e){if(t.forEach||(t=t.split(".")),"$this"===t[0])return this.reset(e);if("$parent"===t[0]){if(this.parent)return this.parent.set(t.slice(1),e);throw new Error("yamvish.Context : there is no parent in current context. could not find : "+t.join("."))}var n=o.setProp(this.data,t,e);return n!==e&&this.notify("set",t,e,t[t.length-1]),this},push:function(t,e){if(t.forEach||(t=t.split(".")),"$parent"==t[0]){if(this.parent)return this.parent.push(t.slice(1),e);throw new Error("yamvish.Context : there is no parent in current context. could not find : "+t.join("."))}var n;if(n="$this"===t[0]?this.data:o.getProp(this.data,t),!n)throw new Error("yamvish.Context : Missing array at "+t.join(".")+" : couldn't push object.");if(!n.forEach)throw new Error("yamvish.Context : Object is not array at "+t.join(".")+" : couldn't push object.");return n.push(e),this.notify("push",t,e,n.length-1),this},del:function(t){if(t=t.forEach?t.slice():t.split("."),"$parent"==t[0]){if(this.parent)return this.parent.del(t.slice(1));throw new Error("yamvish.Context : there is no parent in current context. could not find : "+t.join("."))}var e=t.pop(),n=t.length?o.getProp(this.data,t):this.data;if(n)if(n.forEach){var r=parseInt(e,10);n.splice(r,1),this.notify("removeAt",t,null,r)}else delete n[e],this.notify("delete",t,null,e);return this},get:function(t){if(t.forEach||(t=t.split(".")),"$this"===t[0])return this.data;if("$parent"==t[0]){if(!this.parent)throw new Error("yamvish.Context : there is no parent in current context. could not find : "+t.join("."));return this.parent.get(t.slice(1))}return o.getProp(this.data,t)},subscribe:function(t,e,n){t.forEach||(t=t.split("."));var r;if("$this"===t[0])r=this.map;else{if("$parent"===t[0]){if(this.parent)return this.parent.subscribe(t.slice(1),e,n);throw new Error("yamvish.Context : there is no parent in current context. could not find : "+t.join("."))}r=o.getProp(this.map,t)}n?r?(r._upstreams=r._upstreams||[]).push(e):o.setProp(this.map,t,{_upstreams:[e]}):r?(r._listeners=r._listeners||[]).push(e):o.setProp(this.map,t,{_listeners:[e]});var i=this;return function(){i.unsubscribe(t,e,n)}},unsubscribe:function(t,e,n){t.forEach||(t=t.split("."));var r;if("$this"===t[0])r=this.map;else{if("$parent"===t[0]){if(this.parent)return this.parent.unsubscribe(t.slice(1),e,n),this;throw new Error("yamvish.Context : there is no parent in current context. could not find : "+t.join("."))}r=o.getProp(this.map,t)}if(!r)return this;for(var i=n?r._upstreams:r._listeners,s=0,u=i.length;u>s;++s)if(i[s]===e){i.splice(s,1);break}return this},notifyAll:function(t,e,n,r,i){if(n=n||this.map,r=arguments.length<2?this.data:r,n._listeners)for(var o=0,s=n._listeners.length;s>o;++o)n._listeners[o](t,e,r,i);if("push"!==t&&"removeAt"!==t)for(var u in n)"_listeners"!==u&&"_upstreams"!==u&&this.notifyAll(t,e,n[u],r?r[u]:void 0,i);return this},notify:function(t,e,n,r){e.forEach||(e=e.split(".")),"$this"===e[0]&&(e=[]);for(var o,s=this.map,u=0,a=e.length;a>u&&(o=s["*"],o&&o._upstreams&&i(o,t,e,n,r),s=s[e[u]]);++u)s._upstreams&&i(s,t,e,n,r);return o&&this.notifyAll(t,e,o,n,r),s&&this.notifyAll(t,e,s,n,r),this},setAsync:function(t,e){var n=this;return e.then(function(e){n.set(t,e)},function(t){throw console.error("error while Context.setAsync : ",t),t})}},e.exports=r},{"./utils":13}],4:[function(t,e,n){var r=function(){};r.prototype={addEventListener:function(t,e){return this._events=this._events||{},(this._events[t]=this._events[t]||[]).push(e),this},removeEventListener:function(t,e){return this._events&&t in this._events!=!1?(this._events[t].splice(this._events[t].indexOf(e),1),this):this},dispatchEvent:function(t){if(!this._events||t in this._events==!1)return this;for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1));return this}},e.exports=r},{}],5:[function(t,e,n){function r(t){this._queue=t?t._queue.slice():[]}var i=t("./utils");r.prototype={call:function(t,e){return i.execFilterQueue(t,this._queue,e)},done:function(t){return this._queue.push({type:"done",fn:t}),this},lower:function(){return this.done(function(t){return t.toLowerCase()})},date:function(t){return this.done(function(e){return new Date(e).format(t)})}},e.exports=r},{"./utils":13}],6:[function(t,e,n){function r(t,e){var n=t.split(o);return 1==n.length?t:new i(n,e)}var i=function(t,e){if(this.__interpolable__=!0,this._strict=e,3===t.length&&""===t[0]&&""===t[2])this.directOutput=t[1],this.dependencies=[t[1]];else{this.splitted=t,this.dependencies=[];for(var n=1,r=t.length;r>n;n+=2)this.dependencies.push(t[n])}};i.prototype={subscribeTo:function(t,e){for(var n,r=[],i=this,o=this.dependencies.length,s=0;o>s;++s)r.push(t.subscribe(this.dependencies[s],function(r,s,u){i.directOutput?e(r,s,u):1===o?e(r,s,i.output(t)):n||(n=setTimeout(function(){n&&(n=null,e(r,s,i.output(t)))},1))}));return function(){n=null;for(var t=0;t<r.length;t++)r[t]()}},output:function(t){if(this.directOutput){var e=t.get(this.directOutput);return"undefined"!=typeof e||this._strict?e:""}for(var n="",r=!0,i=0,o=this.splitted.length;o>i;++i){if(r)n+=this.splitted[i];else{var s=t.get(this.splitted[i]);if("undefined"==typeof s){if(this._strict)return;n+=""}n+=s}r=!r}return n}};var o=/\{\{\s*([^\}\s]+)\s*\}\}/;e.exports={interpolable:r,Interpolable:i}},{}],7:[function(t,e,n){function r(t,e){for(var n=e||new this.Template,r=0,o=t.childNodes.length;o>r;++r)i(t.childNodes[r],n);return n}function i(t,e){var n=e||y();switch(t.nodeType){case 1:var i=new this.Template;if(r(t,i),t.id&&i.id(t.id),t.attributes.length)for(var o=0,s=t.attributes.length;s>o;++o){var u=t.attributes[o];i.attr(u.name,u.value)}for(var a=0;a<t.classList;++a)i.setClass(t.classList[a]);n.tag.apply(n,[t.tagName.toLowerCase(),i]);break;case 3:n.text(t.textContent);break;case 4:console.log("element is CDATA : ",t);break;default:console.warn("y.elementToTemplate : DOM node not managed : type : %s, ",t.nodeType,t)}return n}e.exports={elementChildrenToTemplate:r,elementToTemplate:i}},{}],8:[function(t,e,n){function r(t,e){for(var n=new e,r=0,i=t.length;i>r;++r){var o=t[r];n[o.method].apply(n,o.arguments)}return n}var i=t("elenpi/index"),o=i.r,s=i.Parser,u=t("../filter"),a={},l={},c={doublestring:o().regExp(/^"([^"]*)"/,!1,function(t,e){t.arguments.push(e[1])}),singlestring:o().regExp(/^'([^']*)'/,!1,function(t,e){t.arguments.push(e[1])}),"float":o().regExp(/^[0-9]*\.[0-9]+/,!1,function(t,e){t.arguments.push(parseFloat(e[0],10))}),integer:o().regExp(/^[0-9]+/,!1,function(t,e){t.arguments.push(parseInt(e[0],10))}),bool:o().regExp(/^(true|false)/,!1,function(t,e){t.arguments.push("true"===e[1]?!0:!1)}),args:o().zeroOrOne(null,o().regExp(/^\s*\(\s*/).done(function(t,e){return e.arguments=[],t}).zeroOrMore(null,o().oneOf(["integer","bool","singlestring","doublestring"]),o().regExp(/^\s*,\s*/)).regExp(/^\s*\)/)),expression:o().done(function(t,e){return e.keys=[],t}).space().oneOrMore(null,o().regExp(/^[\w-_]+/,!1,function(t,e){t.keys.push(e[0])}),o().regExp(/^\s*\.\s*/)).rule("args").zeroOrOne(null,o().regExp(/^\s*\|\s*/).rule("filters")).space(),filters:o().space().zeroOrMore("filters",o().rule("filter"),o().regExp(/^\s*\.\s*/)).done(function(t,e){return e.filters&&(e.filters=r(e.filters,u)),t}),filter:o().regExp(/^[\w-_]+/,!1,"method").rule("args"),templates:o().space().zeroOrMore("calls",o().rule("template"),o().regExp(/^\s*\.\s*/)).done(function(t,e){var n;return e.calls&&(n=r(e.calls,this.Template)),n&&e.arguments?(e.arguments.push(n),delete e.calls):e.calls=n,t}),template:o().regExp(/^[\w-_]+/,!1,function(t,e){t.method=e[0],t.arguments=[]}).zeroOrOne(null,o().regExp(/^\s*\(\s*/).zeroOrMore(null,o().oneOf(["integer","bool","singlestring","doublestring","templates"]),o().regExp(/^\s*,\s*/)).regExp(/^\s*\)/))},h=new s(c,"expression");h.parseTemplate=function(t){if(void 0!==a[t])return a[t].calls;var e=a[t]=h.parse(t,"templates");return e===!1?!1:e.calls},h.parseFilter=function(t){if(void 0!==l[t])return l[t].filters;var e=l[t]=h.parse(t,"filters");return e===!1?!1:e.filters},e.exports=h},{"../filter":5,"elenpi/index":18}],9:[function(t,e,n){var r=t("elenpi").r,i={openTags:/(br|input|img|area|base|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)/,document:r().zeroOrMore(null,r().space().rule("comment")).regExp(/^\s*<!DOCTYPE[^>]*>\s*/i,!0).rule("children").space(),comment:r().regExp(/^<!--(?:.|\n|\r)*?(?=-->)-->/),tagEnd:r().regExp(/^\s*<\/([\w-_]+)\s*>/,!1,function(t,e){if(t.tagName!==e[1].toLowerCase())throw new Error("tag badly closed : "+e[1]+" - (at opening : "+t.tagName+")")}),innerScript:r().done(function(t,e){var n=t.indexOf("</script>");if(-1==n)throw new Error("script tag badly closed.");return n&&(e.scriptContent=t.substring(0,n)),t.substring(n+9)})};e.exports=i},{elenpi:18}],10:[function(t,e,n){var r=t("elenpi"),i=r.r,o=r.Parser,s=t("../utils.js"),u=t("../template.js"),a=t("./expression"),l=t("./html-common-rules"),c={children:i().zeroOrMore(null,i().oneOf([i().space().rule("comment").skip(),i().space().rule("tag"),i().rule("text")])),text:i().regExp(/^[^<]+/,!1,function(t,e){t.text(e[0])}),tag:i().regExp(/^<([\w-_]+)\s*/,!1,function(t,e){t.tagName=e[1].toLowerCase()}).done(function(t,e){return e._attributesTemplate=new u,this.exec(t,e._attributesTemplate,this.rules.attributes)}).oneOf([i()["char"](">").done(function(t,e){if(this.rules.openTags.test(e.tagName))return t;if("script"===e.tagName)return this.exec(t,e,this.rules.innerScript);e._eachTemplate=new u;var n=this.exec(t,e._eachTemplate,this.rules.children);return n===!1?!1:this.exec(n,e,this.rules.tagEnd)}),i().regExp(/^\/>/)]).done(function(t,e){var n=e._eachTemplate,r=e._attributesTemplate;return n&&(r._hasEach?r._queue.unshift({type:"done",fn:function(t){return this._eachTemplate=n,t}}):r._queue=r._queue.concat(n._queue)),e.tag(e.tagName,r),delete e._attributesTemplate,delete e._eachTemplate,delete e.tagName,t}),attributes:i().zeroOrMore(null,i().regExp(/^([\w-_]+)\s*(?:=(?:"([^"]*)"|([\w-_]+)))?\s*/,!1,function(t,e){var n=e[1],r=void 0!==e[2]?e[2]:void 0!==e[3]?e[3]:"";switch(n){case"class":if(!r)break;r.split(/\s+/).forEach(function(e){t.setClass(e)});break;case"data-template":if(!r)break;var i=a.parseTemplate(r);if(i===!1)throw new Error("data-template attribute parsing failed : "+r);t._queue=t._queue.concat(i._queue),t._hasEach=t._hasEach||i._hasEach;break;case"id":if(!r)break;t.id(r);break;default:t.attr(n,r)}}))};c=s.merge(l,c);var h=new o(c,"children");h.createDescriptor=function(){return new u},e.exports=h},{"../template.js":12,"../utils.js":13,"./expression":8,"./html-common-rules":9,elenpi:18}],11:[function(t,e,n){function r(){this.__yPureNode__=!0}t("./utils");r.prototype={insertBefore:function(t,e){var n=this.childNodes.indexOf(e);return-1==n?!1:(0==n?this.childNodes.unshift(t):this.childNodes.splice(n,0,t),!0)},appendChild:function(t){return(this.childNodes=this.childNodes||[]).push(t),t.parentNode=this,t},removeChild:function(t){if(!this.childNodes)return!1;for(var e=0,n=this.childNodes.length;n>e;++e)if(this.childNodes[e]===t)return t.parentNode=null,this.childNodes.splice(e,1),t;return!1},toString:function(){if(!this.childNodes)return"";for(var t="",e=0,n=this.childNodes.length;n>e;++e)t+=this.childNodes[e].toString();return t}},e.exports=r},{"./utils":13}],12:[function(t,e,n){!function(){"use strict";function n(){this.attributes="",this.classes="",this.children="",this.style=""}function r(t){t?(this._queue=t._queue.slice(),this._hasEach=t._hasEach):this._queue=[]}function i(t,e,n,r,i,o){try{e.call(t,n,r,i,o)}catch(s){return s}}function o(t,e,n,r,o,s){for(var u,a=e[0],l=0;a;){if(l++,s){if("catch"!==a.type||!a.toElement){a=e[l];continue}return void i(t,a.toElement,n,r,o,s)}"catch"!==a.type&&a.toElement?(u=i(t,a.toElement,n,r,o),u&&(s=u),a=e[l]):a=e[l]}if(s)throw s}var s=t("./utils"),u=t("./interpolable").interpolable,a=(t("./parsers/dom-to-template"),t("./virtual")),l=t("./pure-node"),c=t("./container"),h=t("./context"),f=function(){return new r},p=function(t,e){if(e=e||t._eachTemplate,!e)throw s.produceError("no template for .each template handler",t);return e};r.prototype={call:function(t,e,n,r){o(t,this._queue,e,n||(s.isServer?a:document),r)},toElement:function(t,e,n){n=n||[];var r=new c({factory:e});return o(r,this._queue,t,e||(s.isServer?a:document),n),n.length&&(r.promises=n),r},toString:function(t,e,r){e=e||new n;for(var i=0,o=this._queue.length;o>i;++i)this._queue[i].toString&&this._queue[i].toString(t,e,r);return e.children},exec:function(t,e){return this._queue.push({type:"exec",toElement:t,toString:e===!0?t:e}),this},"catch":function(t,e){return this._queue.push({type:"catch",toElement:t,toString:e===!0?t:e}),this},"if":function(t,e,n){var r=typeof t;return"string"===r&&(t=u(t)),this.exec(function(i,o,s){var u=t,a=this,l=function(t,r,u){return u?e.call(a,i,o,s):n?n.call(a,i,o,s):void 0};return t&&t.__interpolable__?(u=t.output(i),(this._binds=this._binds||[]).push(t.subscribeTo(i,l))):"function"===r&&(u=t.call(this,i)),l("set",u)},function(i,o,s){var u;return t&&t.__interpolable__?u=t.output(i):"function"===r&&(u=t.call(this,i)),u?e.toString(i,o,s):n?n.toString(i,o,s):void 0})},set:function(t,e){return this.exec(function(n){if(!n)throw s.produceError("no context avaiable to set variable in it. aborting.",this);n.set(t,e)},!0)},push:function(t,e){return this.exec(function(n){n.push(t,e)},!0)},del:function(t){return this.exec(function(e){e.del(t)},!0)},setHandler:function(t,e){return this.exec(function(n){(n.handlers=n.handlers||{})[t]=e})},context:function(t){var e;return"string"==typeof t&&(e=t),this.exec(function(n){this.context=new h({data:e?null:t,parent:n,path:e?e:null})},!0)},sub:function(t,e,n){return this.exec(function(r){r.subscribe(t,e,n)})},unsub:function(t,e,n){return this.exec(function(r){r.unsubscribe(t,e,n)})},"with":function(t,e){return this.exec(function(n,r,i){var o=new h({data:"string"==typeof t?n.get(t):t,parent:n,path:t});e.call(this,o,r,i)},function(t,r){var i=new n;e.toString(t,i),r.attributes+=i.attributes,i.style&&(r.style+=i.style),i.classes&&(r.classes+=i.classes),i.children&&(r.children+=i.children)})},attr:function(t,e){return"string"==typeof e&&(e=u(e)),(this._attributes=this._attributes||[]).push({name:t,value:e}),this.exec(function(n){var r=this,i=e;e.__interpolable__&&(i=e.output(n),(this._binds=this._binds||[]).push(e.subscribeTo(n,function(e,n,i){r.setAttribute(t,i)}))),this.setAttribute(t,i)},function(n,r){return r.attributes+=" "+t,e&&(r.attributes+='="'+(e.__interpolable__?e.output(n):e)+'"'),""})},removeAttr:function(t){return this.exec(function(e){this.removeAttribute(t)},function(t,e){})},disabled:function(t){var e=!1;return t&&"!"===t[0]&&(t=t.substring(1),e=!0),this.exec(function(n){var r=this,i=function(t,n,i){e&&(i=!i),i?r.setAttribute("disabled"):r.removeAttribute("disabled")};"string"==typeof t?((this._binds=this._binds||[]).push(n.subscribe(t,i)),i("set",null,n.get(t))):i("set",null,void 0!==t?t:!0)},function(e,n){(void 0===t||e.get(t))&&(n.attributes+=" disabled")})},val:function(t){return"string"==typeof t&&(t=u(t)),this.exec(function(e){var n=this;t.__interpolable__?(s.isServer||this.addEventListener("input",function(n){e.set(t.directOutput,n.target.value)}),(this._binds=this._binds||[]).push(t.subscribeTo(e,function(t,e,r){n.setAttribute("value",r)})),this.setAttribute("value",t.output(e))):this.setAttribute("value",t)},function(e,n){n.attributes+=' value="'+(t.__interpolable__?t.output(e):t)+'"'})},contentEditable:function(t){return"string"==typeof t&&(t=u(t)),this.exec(function(e,n){var r,i,o=this;this.setAttribute("contenteditable",!0),t.__interpolable__?(i=e.get(t.directOutput),s.isServer||this.addEventListener("input",function(n){o.freeze=!0,e.set(t.directOutput,n.target.textContent)}),(this._binds=this._binds||[]).push(t.subscribeTo(e,function(t,e,n){o.freeze||(o.nodeValue=n,o.el&&(o.el.nodeValue=n)),o.freeze=!1}))):i=t,r=n.createTextNode(i),this.appendChild(r)},function(t,e){e.attributes+=" contenteditable"})},setClass:function(t,e){var n=!1;return e&&"!"===e[0]&&(e=e.substring(1),n=!0),this.exec(function(r){function i(e,r,i){n&&(i=!i),i?s.setClass(o,t):s.removeClass(o,t)}var o=this;void 0!==e?"string"==typeof e?((this._binds=this._binds||[]).push(r.subscribe(e,i)),i("set",null,r.get(e))):i("set",null,e):i("set",null,!0)},function(r,i){(void 0===e||(n?!r.get(e):r.get(e)))&&(i.classes+=" "+t)})},css:function(t,e){return"string"==typeof e&&(e=u(e)),this.exec(function(n){var r=e,i=this;e.__interpolable__&&(r=e.output(n),(this._binds=this._binds||[]).push(e.subscribeTo(n,function(e,n,r){i.style[t]=r}))),(this.style=this.style||{})[t]=r},function(n,r){r.style+=t+":"+(e.__interpolable__?e.output(n):e)})},visible:function(t){var e=!1;return"!"===t[0]&&(t=t.substring(1),e=!0),this.exec(function(n){var r=t,i=this,o=(this.style?this.style.display:"")||"";this.style||(this.style={}),"string"==typeof t&&(r=n.get(t),(this._binds=this._binds||[]).push(n.subscribe(t,function(t,n,r){e&&(r=!r),i.style.display=r?o:"none"}))),e&&(r=!r),this.style.display=r?o:"none"},function(n,r){var i="string"==typeof t?n.get(t):t;e&&(i=!i),i||(r.style+="display:none;")})},text:function(t){return"string"==typeof t&&(t=u(t)),this.exec(function(e,n){var r;t.__interpolable__?(r=n.createTextNode(t.output(e)),(this._binds=this._binds||[]).push(t.subscribeTo(e,function(t,e,n){r.__yVirtual__&&(r.nodeValue=n,r.el&&(r.el.nodeValue=n)),r.nodeValue=n}))):r=n.createTextNode(t),this.appendChild(r)},function(e,n){n.children+=t.__interpolable__?t.output(e):t})},tag:function(t){for(var e=[],r=1,i=arguments.length;i>r;++r)e.push(arguments[r].call?arguments[r]:f().text(arguments[r]));return this.exec(function(n,r,i){for(var o,s=r.createElement(t),i=[],u=0,a=e.length;a>u;++u)o=e[u].call(s,this.childrenContext||n,r,i),o&&o.then&&i.push(o);return this.appendChild(s),i.length?Promise.all(i):void 0},function(r,i){var o="<"+t;this._id&&(o+=' id="'+this._id+'"');for(var s=new n,u=0,a=e.length;a>u;u++)e[u].toString&&e[u].toString(r,s);o+=s.attributes,s.style&&(o+=' style="'+s.style+'"'),s.classes&&(o+=' class="'+s.classes+'"'),s.children?i.children+=o+">"+s.children+"</"+t+">":i.children+=o+"/>"})},a:function(t){var e=Array.prototype.slice.call(arguments,1);return e.unshift("a",f().attr("href",t)),this.tag.apply(this,e)},input:function(t,e){var n=Array.prototype.slice.call(arguments,2),r=f().attr("type",t);return e&&r.val(e),n.unshift("input",r),this.tag.apply(this,n)},h:function(t){var e=Array.prototype.slice.call(arguments,1);return e.unshift("h"+t),this.tag.apply(this,e)},on:function(t,e){return this.exec(function(n){if(!s.isServer){var r;if("string"==typeof e){if(!n.handlers||!n.handlers[e])throw s.produceError("on("+t+') : no "'+e+'" handlers define in current context',this);r=n.handlers[e]}else r=e;this.addEventListener(t,function(t){return r.call(n,t)})}})},off:function(t,e){return this.exec(function(){this.removeEventListener(t,e)})},each:function(t,e){return this._hasEach=!0,this.exec(function(n,r,i){function o(t,e){var o=new h({data:t,parent:n}),s=new l;return s.context=o,c.childNodes.push(s),a.call(s,o,r,i),s}var u=this,a=p(this,e),c=new l;c.childNodes=[],this.__yPureNode__?this.appendChild(c):(this._yamvish_containers=this._yamvish_containers||[]).push(c);var f=function(t,e,n,r){switch(e.forEach&&(e=e.join(".")),t){case"reset":case"set":for(var i,a=0,l=!u.__yPureNode__||u.mountPoint?s.findNextSibling(c):null,h=n.length;h>a;++a)if(c.childNodes[a])c.childNodes[a].context.reset(n[a]);else{var f=o(n[a]);u.__yPureNode__&&!u.mountPoint||!f.childNodes||s.mountChildren(f,i||u.mountPoint||u,i?null:l)}if(a<c.childNodes.length){for(var p=a,d=c.childNodes.length;d>a;++a)s.destroyElement(c.childNodes[a],!0);c.childNodes.splice(p)}break;case"removeAt":s.destroyElement(c.childNodes[r],!0),c.childNodes.splice(r,1);break;case"push":var l=s.findNextSibling(c),f=o(n);u.__yPureNode__&&!u.mountPoint||!f.childNodes||s.mountChildren(f,u.mountPoint||u,l)}},d=t;return"string"==typeof t&&((this._binds=this._binds||[]).push(n.subscribe(t,f)),(this._binds=this._binds||[]).push(n.subscribe(t+".*",function(t,e,n,r){var i=c.childNodes[r];i&&i.context.reset(n)})),d=n.get(t)),d?f("set",t,d):void 0},function(r,i){var o=p(this,e),s=new n,u="string"==typeof t?r.get(t):t;if(u)for(var a=0,l=u.length;l>a;++a)o.toString(new h({data:u[a],parent:r}),s);i.children+=s.children})},from:function(t){return this.exec(function(t,e,n){},function(t,e,n){})}},["div","span","ul","li","button","p"].forEach(function(t){r.prototype[t]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift(t),this.tag.apply(this,e)}}),["click","blur","focus"].forEach(function(t){r.prototype[t]=function(e){return this.on(t,e)}}),e.exports=r}()},{"./container":2,"./context":3,"./interpolable":6,"./parsers/dom-to-template":7,"./pure-node":11,"./utils":13,"./virtual":15}],13:[function(t,e,n){function r(t,e){var n=new Error(t);return n.report=e,n}function i(t,e){t.__yVirtual__?(t.el&&t.el.classList.add(e),(t.classes=t.classes||{})[e]=!0):t.classList.add(e)}function o(t,e){t.__yVirtual__?(t.el&&t.el.classList.remove(e),t.classes&&delete t.classes[e]):t.classList.remove(e)}function s(t,e){if("$this"===e[0])return t;for(var n=t,r=0,i=e.length;i>r;++r)if(!n||void 0===(n=n[e[r]]))return;return n}function u(t,e){var n=t,r=0;for(len=e.length-1;r<len;++r)if(n&&!(n=n[e[r]]))return;n&&delete n[e[r]]}function a(t,e,n){for(var r,i=t,o=0,s=e.length-1;s>o;++o)i=i&&!i[e[o]]?i[e[o]]={}:i[e[o]];return i&&(r=i[e[o]],i[e[o]]=n),r}function l(t){if(t.childNodes&&t.childNodes.length){for(var e=0,n=t.childNodes.length;n>e;++e)c(t.childNodes[e]);t.__yVirtual__?t.childNodes=[]:t.innerHTML=""}}function c(t,e){if(e&&t.parentNode&&(t.parentNode.removeChild(t),t.parentNode=null),t.__yPureNode__?(t.__yVirtual__&&(t.attributes=void 0,t.listeners=void 0,t.classes=void 0,t.style=void 0),t.childNodes&&t.childNodes.length&&h(t,e)):t.childNodes&&t.childNodes.length&&h(t),t._binds){for(var n=0,r=t._binds.length;r>n;n++)t._binds[n]();t._binds=null}t._yamvish_containers&&(t._yamvish_containers=null)}function h(t,e){if(t.childNodes)for(var n=0;n<t.childNodes.length;n++)c(t.childNodes[n],e)}function f(t,e){for(var n in t)e[n]=t[n]}function p(t,e,n){for(var r=e[0],i=0,o=n;r;)o=r.fn.call(t,o),r=e[++i];return o}function d(t,e,n){if(t.childNodes&&t.__yPureNode__)if(n)for(var r=t.childNodes.length-1;r>=0;--r){var i=t.childNodes[r];i.__yPureNode__&&!i.__yVirtual__?d(i,e,n):e.insertBefore(i,n)}else for(var o=0,s=t.childNodes.length;s>o;++o){var i=t.childNodes[o];i.__yPureNode__&&!i.__yVirtual__?d(i,e):e.appendChild(i)}}function g(t){for(var e=t;e&&!e.__yVirtual__&&e.__yPureNode__&&e.childNodes&&e.childNodes.length;)e=e.childNodes[e.childNodes.length-1];return!e||e.__yPureNode__&&!e.__yVirtual__?null:e.nextSibling}e.exports={isServer:"undefined"==typeof window&&"undefined"==typeof document,mountChildren:d,execFilterQueue:p,mergeProto:f,destroyElement:c,destroyChildren:h,setProp:a,deleteProp:u,getProp:s,emptyNode:l,produceError:r,setClass:i,removeClass:o,findNextSibling:g,merge:function(t,e){var n={};for(var r in t)n[r]=t[r];for(var i in e)n[i]=e[i];return n},domQuery:function(t){return"#"===t[0]?document.getElementById(t.substring(1)):document.querySelector(t)}}},{}],14:[function(t,e,n){var r=t("./utils"),i=t("./template"),o=t("./virtual"),s=t("./container"),u=t("./context"),a=function(t){t=t||{},t.componentName&&addComponent(t.componentName,this),this.factory=t.factory,u.call(this,t),s.call(this,t),this.promises=[]};r.mergeProto(i.prototype,a.prototype),r.mergeProto(u.prototype,a.prototype),r.mergeProto(s.prototype,a.prototype),a.prototype.exec=function(t){return t.call(this,this,this.factory||(r.isServer?o:document),this.promises),this},a.prototype.destroy=function(){s.prototype.destroy.call(this),u.prototype.destroy.call(this)},delete a.prototype["catch"],delete a.prototype.call,delete a.prototype.toElement,delete a.prototype.context,delete a.prototype.id,delete a.prototype.attr,delete a.prototype.setClass,delete a.prototype.visible,delete a.prototype.css,delete a.prototype.val,delete a.prototype.contentEditable,e.exports=a},{"./container":2,"./context":3,"./template":12,"./utils":13,"./virtual":15}],15:[function(t,e,n){function r(t){t=t||{},this.__yVirtual__=!0,t.tagName&&(this.tagName=t.tagName),t.nodeValue&&(this.nodeValue=t.nodeValue),s.call(this,t)}var i=t("./utils"),o=t("./emitter"),s=t("./pure-node"),u=/(br|input|img|area|base|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)/;r.prototype={setAttribute:function(t,e){(this.attributes=this.attributes||{})[t]=e},removeAttribute:function(t,e){this.attributes&&delete this.attributes[t]}},i.mergeProto(s.prototype,r.prototype),i.mergeProto(o.prototype,r.prototype),r.prototype.toString=function(){if("textnode"===this.tagName)return this.nodeValue;var t="<"+this.tagName;this.id&&(t+=' id="'+this.id+'"');for(var e in this.attributes)t+=" "+e+'="'+this.attributes[e]+'"';if(this.classes){var n=Object.keys(this.classes);n.length&&(t+=' class="'+n.join(" ")+'"')}if(this.childNodes&&this.childNodes.length){t+=">";for(var r=0,i=this.childNodes.length;i>r;++r)t+=this.childNodes[r].toString();t+="</"+this.tagName+">"}else t+=this.scriptContent?">"+this.scriptContent+"</script>":u.test(this.tagName)?">":" />";return t},r.createElement=function(t){return new r({tagName:t})},r.createTextNode=function(t){return new r({tagName:"textnode",nodeValue:t})},e.exports=r},{"./emitter":4,"./pure-node":11,"./utils":13}],16:[function(t,e,n){!function(t){"use strict";function n(t,e,n,r,i,u){i&&r&&(i+="."),i=r?i+r:i,i||(i="."),t.valid=!1,t.map[i]=t.map[i]||{value:r?n[r]:n,errors:[]};var a=s(e);return a||(a="missing error message for "+e),u&&(a=a.replace(o,u)),t.map[i].errors.push(a),!1}function r(t){return function(){return this.exec("this",function(e,r){return typeof e!==t?n(this,t,e,null,r,t):!0})}}function i(t){return function(e,r){return this.exec(e,function(i,o){return"undefined"==typeof i[e]?r&&r.required===!1?!0:n(this,"missing",i,e,o):typeof i[e]!==t?n(this,t,i,e,o,t):r?r.call(this,i[e],o?o+"."+e:e):!0})}}var o=/%s/g,s=function(t,e){var n=s.data[e||s.currentLanguage];return n[t]};s.currentLanguage="en",s.data={en:{string:"should be a string",object:"should be an object",array:"should be an array","boolean":"should be a boolean",number:"should be a number","null":"should be null","enum":"enum failed (should be one of : %s)",equal:"equality failed (should be : %s)",format:"format failed",unmanaged:"unmanaged property",missing:"missing property",minLength:"too short (length should be at least : %s)",maxLength:"too long (length should be at max : %s)",minimum:"too small (should be at minimum : %s)",maximum:"too big (should be at max : %s)"}};var u={email:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i},a=function(){this._rules={}};a.prototype={validate:function(t){var e={valid:!0,map:{}};return this.call(e,t,""),e.valid?!0:(e.value=t,e)},call:function(t,e,r){var i=!0;if(this.required!==!1&&"undefined"==typeof e)return n(t,"missing",e,null,r);if(this._rules["this"]&&this._rules["this"].forEach(function(n){i=i&&n.call(t,e,r)}),!i)return!1;if("object"!=typeof e||e.forEach)return i;var o,s={};for(o in e)s[o]=!0;for(o in this._rules){if("this"===o)continue;var u=this._rules[o].call(t,e,r);s[o]=!1,i=i&&u}for(o in s)s[o]&&(i=n(t,"unmanaged",e,o,r));

return i},exec:function(t,e){return"string"==typeof e&&(e=c[e]),"this"===t?(this._rules[t]=this._rules[t]||[]).push(e):this._rules[t]=e,this},rule:function(t,e){return e||(e=t,t=null),"string"==typeof e&&(e=c[e]),this.exec(t||"this",function(n,r){return n=t?n[t]:n,t&&(r=r?r+"."+t:t),e.call(this,n,r)})},required:function(t){return this.required=t,this},minLength:function(t){return this.exec("this",function(e,r){return e.length<t?n(this,"minLength",e,null,r,t):!0})},maxLength:function(t){return this.exec("this",function(e,r){return e.length>t?n(this,"maxLength",e,null,r,t):!0})},minimum:function(t){return this.exec("this",function(e,r){return t>e?n(this,"minimum",e,null,r,t):!0})},maximum:function(t){return this.exec("this",function(e,r){return e>t?n(this,"maximum",e,null,r,t):!0})},format:function(t){return"string"==typeof t&&(t=u[t]),this.exec("this",function(e,r){return t.test(e)?!0:n(this,"format",e,null,r)})},enumerable:function(t){return this.exec("this",function(e,r){return-1===t.indexOf(e)?n(this,"enum",e,null,r,t.join(", ")):!0})},item:function(t){return this.exec("this",function(e,n){var r=this,i=0,o=!0;return e.forEach(function(e){o=o&&t.call(r,e,n+"."+i++)}),o})},equal:function(t){return this.exec("this",function(e,r){return e!==t?n(this,"equal",e,name,r,t):void 0})},isObject:r("object"),object:i("object"),isString:r("string"),string:i("string"),func:i("function"),bool:i("boolean"),number:i("number"),isArray:function(){return this.exec("this",function(t,e){return"object"==typeof t||t.forEach?!0:n(this,"array",t,null,e)})},isNull:function(){return this.exec("this",function(t,e){return null!==t?n(this,"null",t,null,e):!0})},"null":function(t){return this.exec(t,function(e,r){return null!==e[t]?n(this,"null",e,t,r):!0})},array:function(t,e){return this.exec(t,function(r,i){return"undefined"==typeof r[t]?e&&e.required===!1?!0:n(this,"missing",r,t,i):"object"==typeof r[t]||r[t].forEach?e?e.call(this,r[t],i?i+"."+t:t):!0:n(this,"array",r,t,i)})}};var l=function(){return new a},c={email:l().isString().format("email").minLength(6)},h={v:l,Validator:a,rules:c,i18n:s,formats:u};"undefined"!=typeof e&&e.exports?e.exports=h:t.aright=h}(this)},{}],17:[function(e,n,r){!function(t){"use strict";t("c3po",[],function(){function t(t,e){var n=i.exec(t);n&&(e.protocol=n[1],e.method=n[2]||"get",e.args=n[3]?n[3].split(",").map(function(t){return t.trim()}):null,e.pointer=n[4],e.interpolable=s.interpolator?s.interpolator.isInterpolable(e.pointer):!1)}function e(t,e,n){if(!t[e.method])throw new Error("there is no method named "+e.method+" in protocol "+e.protocol+"!");return t[e.method].apply(t,n)}function n(t){if("string"==typeof t){var e;if(s.fromGlocal&&(e=s.fromGlocal(t)),e||(e=s.protocols[t]),!e)throw new Error("no protocol found with : ",t);return e}return t}function r(t){return new Promise(function(e,n){var r=t.initialising?t.initialising:t.init();r&&"function"==typeof r.then?t.initialising=r.then(function(){t.initialising=null,t.initialised=!0,e(t)},n):(t.initialised=!0,e(t))})}var i=/^([\w-]+)(?:\.([\w-]+)(?:\(([^\)]*)\))?)?::([^$]*)/,o=function(e){this.__c3po__=!0,this.original=e,e&&"<"===e[0]||t(e,this)};o.prototype={exec:function(t,n){if(!this.protocol)return Promise.resolve(this.original);t=t||t;var r=s.protocol(this.protocol),i=this.interpolable&&s.interpolator&&n?s.interpolator.interpolate(this.pointer,n):this.pointer,o=this,u=this.args?[].concat(this.args,i,t):[i,t];return r.then(function(t){return e(t,o,u)})}};var s={Request:o,requestCache:null,protocols:{dummy:{get:function(t){return{dummy:t}}}},fromGlocal:null,interpolator:null,protocol:function(t){return new Promise(function(e,i){var o=n(t);return o._deep_flattener_&&!o._deep_flattened_?(o._deep_flattening_?o._deep_flattening_:o.flatten()).then(s.protocol).then(e,i):(o._deep_ocm_&&(o=o()),o.init&&!o.initialised?r(o).then(e,i):void e(o))})},get:function(t,e,n){return t.__c3po__||(this.requestCache&&this.requestCache[t]?t=this.requestCache[t]:(t=new o(t),this.requestCache&&(this.requestCache[t.original]=t))),t.exec(e,n)},getAll:function(t,e,n){return Promise.all(t.map(function(t){return s.get(t,e,n)}))}};return s})}("undefined"!=typeof t?t:function(t,e,r){"undefined"!=typeof n?n.exports=r():"undefined"!=typeof window?window[t]=r():console.warn('"%s" has not been mounted somewhere.',t)})},{}],18:[function(t,e,n){!function(){function t(e,n,r,i,o){"string"==typeof n&&(n=i.rules[n]);for(var s=n._queue,u=0,a=s.length;a>u;++u){var l=s[u];if(e=l.__lexer__?t(e,l,r,i,o):l.call(i,e,r,o),e===!1)return!1}return e}function n(){this._queue=[],this.__lexer__=!0}var r=/^[\s\n\r]+/;n.prototype={done:function(t){return this._queue.push(t),this},log:function(t){return t=t||"",this.done(function(e,n,r){return console.log("elenpi.log : ",t,e,n),e})},regExp:function(t,e,n){return this.done(function(r,i,o){if(!r)return e?r:!1;var s=t.exec(r);return s?(n&&("string"==typeof n?i[n]=s[0]:n.call(this,i,s,o)),r.substring(s[0].length)):e?r:!1})},"char":function(t,e){return this.done(function(n,r){return n?n[0]===t?n.substring(1):e?n:!1:!1})},xOrMore:function(e,n,r,i){return i=i||0,this.done(function(o,s,u){for(var a=[],l=!0,c=0;l&&o;){var h=e?this.createDescriptor?this.createDescriptor():{}:s;l=t(o,n,h,this,u),l!==!1&&(c++,o=l,h.skip||a.push(h),r&&o&&(l=t(o,r,h,this,u),l!==!1&&(o=l)))}return i>c?!1:(e&&a.length&&(s[e]=a),o)})},zeroOrMore:function(t,e,n){return this.xOrMore(t,e,n,0)},oneOrMore:function(t,e,n){return this.xOrMore(t,e,n,1)},zeroOrOne:function(e,n){return 1===arguments.length&&(n=e,e=null),this.done(function(r,i,o){if(!r)return r;var s=e?this.createDescriptor?this.createDescriptor():{}:i,u=t(r,n,s,this,o);return u!==!1&&(e&&(i[e]=s),r=u),r})},oneOf:function(e,n,r){return 1===arguments.length&&(n=e,e=null),this.done(function(i,o,s){if(!i)return!1;for(var u=0;u<n.length;){var a=e?this.createDescriptor?this.createDescriptor():{}:o,l=t(i,n[u],a,this,s);if(l!==!1)return e&&(o[e]=a),l;u++}return r?i:!1})},rule:function(e){return this.done(function(n,r,i){var o=this.rules[e];if(!o)throw new Error("elenpi.Rule :  rules not found : "+e);return t(n,o,r,this,i)})},skip:function(){return this.done(function(t,e){return e.skip=!0,t})},space:function(t){return this.done(function(e,n){if(!e)return t?!1:e;var i=(this.rules.space||r).exec(e);return i?e.substring(i[0].length):t?!1:e})},end:function(t){return this.done(function(e,n){return e&&t?!1:e})}};var i=function(t,e){this.rules=t,this.defaultRule=e};i.prototype={exec:function(e,n,r,i){return r||(r=this.rules[this.defaultRule]),t(e,r,n,this,i)},parse:function(t,e,n){var r=this.createDescriptor?this.createDescriptor():{},i=this.exec(t,r,e,n);return i===!1||i.length>0?!1:r}};var o={r:function(){return new n},Rule:n,Parser:i};"undefined"!=typeof e&&e.exports?e.exports=o:this.elenpi=o}()},{}],19:[function(t,e,n){!function(n){"use strict";function r(t,e){if(!e||!e.forEach)return!1;if(t.forEach){var n={};e.forEach(function(t){n[t]=!0});var r=0;return t.forEach(function(t){n[t]&&r++}),r==t.length?!0:!1}return e.some(function(e){return t===e})}function i(t){if("object"==typeof t){var e=t.name,n=t.args;if(t.forEach)return t.map(i);var r=n[0],s=null;2==n.length&&(s=r,r=n[1]);var u=null,a=!1;switch(e){case"eq":a=!0,u=function(t){return(o(t,s)||void 0)===r};break;case"ne":a=!0,u=function(t){return(o(t,s)||void 0)!==r};break;case"le":a=!0,u=function(t){return(o(t,s)||void 0)<=r};break;case"ge":a=!0,u=function(t){return(o(t,s)||void 0)>=r};break;case"lt":a=!0,u=function(t){return(o(t,s)||void 0)<r};break;case"gt":a=!0,u=function(t){return(o(t,s)||void 0)>r};break;default:var l=f.ops[e];if(!l)throw new Error("RQLError : no operator found in rql with : "+e);n&&n.length>0?(n=n.map(i),u=function(){return l.apply(this,n)}):u=function(){return l.call(this)}}return a?function(){var t=this.filter(u);return t}:u}return t}function o(t,e){if(!e)return t;var n=e.split("."),r=t;if(r){for(var i=0,o=n[i];o&&r[o];)r=r[o],o=n[++i];return i===n.length?r instanceof Date?r.valueOf():r:void 0}}function s(t,e){var n=function(e,n){"undefined"==typeof n&&(n=e,e=void 0);for(var r=(arguments,[]),i=0,o=this.length;o>i;i++){var s=this[i];t(a(s,e),n)&&r.push(s)}return r};return n.condition=t,n}function u(t){return function(e){return e?this.map(function(t){return o(t,e)}).reduce(t):this.reduce(t)}}function a(t,e){return e&&e.forEach?o(t,decodeURIComponent(e)):"undefined"==typeof e?o(t):o(t,decodeURIComponent(e))}var l=t("rql/parser"),c=l.parseQuery,h={},f=function(t,e){return"?"==e[0]&&(e=e.substring(1)),h[e]?h[e].call(t):f.compile(e).call(t)};f.parse=function(t){try{var e=c(t);return e.toString=function(){return t},e}catch(n){return null}},f.compile=function(t){var e=f.parse(t),n=i(e);return h[t]=n,n};var p=1;f.ops={isPresent:function(t,e){for(var n=[],r=e.length,i=0;r>i;++i)o(e[i],t)&&n.push(e[i]);return n},sort:function(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e],r=n.charAt(0),i={attribute:n,ascending:!0};("-"==r||"+"==r)&&("-"==r&&(i.ascending=!1),i.attribute=i.attribute.substring(1)),t.push(i)}return this.sort(function(e,n){for(var r=1,i=t[0];i;r++){var s=o(e,i.attribute),u=o(n,i.attribute);if(s!=u)return i.ascending==s>u?1:-1;i=t[r]}return 0}),this},match:s(function(t,e){return new RegExp(e).test(t)}),"in":s(function(t,e){for(var n=!1,r=0;!n&&r<e.length;)e[r++]==t&&(n=!0);return n}),out:s(function(t,e){for(var n=!0,r=0;n&&r<e.length;)e[r++]==t&&(n=!1);return n}),contains:s(function(t,e){return r(e,t)}),excludes:s(function(t,e){return!r(e,t)}),or:function(){var t,e,n=[],r="__rqlId"+p++;try{for(t=0;t<arguments.length;t++){var i=arguments[t].call(this);e=i.length;for(var o=0;e>o;o++){var s=i[o];s[r]||(s[r]=!0,n.push(s))}}}finally{for(t=0,e=n.length;e>t;t++)delete n[r]}return n},and:function(){for(var t=this,e=0;e<arguments.length;++e){var n=arguments[e];t="function"==typeof n?n.call(t):f.ops.isPresent(n,t)}return t},select:function(){var t=arguments,e=arguments.length,n=this.map(function(n){for(var r={},i=0;e>i;i++){var o=t[i],s=a(n,o);"undefined"!=typeof s&&(r[o]=s)}return r});return n},unselect:function(){var t=arguments,e=arguments.length;return this.map(function(n){var r={};for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i]);for(var o=0;e>o;o++)delete r[t[o]];return r})},values:function(t){if(1==arguments.length)return this.map(function(e){return o(e,t)});var e=arguments,n=arguments.length;return this.map(function(t){var r=o(t),i=[];if(0===n)for(var s in r)r.hasOwnProperty(s)&&i.push(r[s]);else for(var u=0;n>u;u++){var a=e[u];i.push(r[a])}return i})},limit:function(t,e,n){var r=this.length;e=e||0;var i=this.slice(e,e+t);return n&&(i.start=e,i.end=e+i.length-1,i.totalCount=Math.min(r,"number"==typeof n?n:1/0)),i},distinct:function(){var t={},e=[],n=this.filter(function(n){return n=o(n),n&&"object"==typeof n?n.__found__?!1:(n.__found__=function(){},e.push(n),!0):t[n]?!1:(t[n]=!0,!0)});return e.forEach(function(t){delete t.__found__}),n},recurse:function(t){function e(r){if(r.forEach)r.forEach(e);else if(n.push(r),t)r=r[t],r&&"object"==typeof r&&e(r);else for(var i in r)r[i]&&"object"==typeof r[i]&&e(r[i])}var n=[];return e(o(this)),n},aggregate:function(){for(var t=[],e=[],n=0;n<arguments.length;n++){var r=arguments[n];"function"==typeof r?e.push(r):t.push(r)}var i={},s=t.length;this.forEach(function(e){e=o(e);for(var n="",r=0;s>r;r++)n+="/"+e[t[r]];var u=i[n];u||(u=i[n]=[]),u.push(e)});var u=e.length,a=[];for(var l in i){for(var c=i[l],h={},f=0;s>f;f++){var p=t[f];h[p]=c[0][p]}for(var d=0;u>d;d++){var g=e[d];h[d]=g.call(c)}a.push(h)}return a},between:s(function(t,e){return t=o(t),t>=e[0]&&t<e[1]}),sum:u(function(t,e){return o(t)+o(e)}),mean:function(t){return f.ops.sum.call(this,t)/this.length},max:u(function(t,e){return Math.max(o(t),o(e))}),min:u(function(t,e){return Math.min(o(t),o(e))}),count:function(){return this.length},first:function(){return this[0]},last:function(){return this[this.length-1]},random:function(){return this[Math.round(Math.random()*(this.length-1))]},one:function(){if(this.length>1)throw new Error("RQLError : More than one object found");return this[0]}},"undefined"!=typeof e&&e.exports?e.exports=f:n.orql=f}(this)},{"rql/parser":20}],20:[function(e,n,r){({define:"undefined"!=typeof t?t:function(t,i){n.exports=i(r,e("./util/contains"))}}).define(["exports","./util/contains"],function(t,e){function n(n,o){function s(n){l.args.push(n),l=n,e(t.lastSeen,l.name)&&(c.cache[l.name]=l.args)}function u(t){if(l.name){if(l.name!==t)throw new Error("Can not mix conjunctions within a group, use paranthesis around each set of same conjuctions (& and |)")}else l.name=t}function a(t){if(t&&t.args){delete t.parent;for(var e=t.args,n=0,r=e.length;r>n;n++)a(e[n])}return t}("undefined"==typeof n||null===n)&&(n="");var l=new t.Query,c=l;if(c.cache={},"object"==typeof n){if(n instanceof t.Query)return n;for(var h in n){var l=new t.Query;c.args.push(l),l.name="eq",l.args=[h,n[h]]}return c}if("?"==n.charAt(0))throw new URIError("Query must not start with ?");t.jsonQueryCompatible&&(n=n.replace(/%3C=/g,"=le=").replace(/%3E=/g,"=ge=").replace(/%3C/g,"=lt=").replace(/%3E/g,"=gt=")),n.indexOf("/")>-1&&(n=n.replace(/[\+\*\$\-:\w%\._]*\/[\+\*\$\-:\w%\._\/]*/g,function(t){return"("+t.replace(/\//g,",")+")"})),n=n.replace(/(\([\+\*\$\-:\w%\._,]+\)|[\+\*\$\-:\w%\._]*|)([<>!]?=(?:[\w]*=)?|>|<)(\([\+\*\$\-:\w%\._,]+\)|[\+\*\$\-:\w%\._]*|)/g,function(t,e,n,r){if(n.length<3){if(!i[n])throw new URIError("Illegal operator "+n);n=i[n]}else n=n.substring(1,n.length-1);return n+"("+e+","+r+")"}),"?"==n.charAt(0)&&(n=n.substring(1));var f=n.replace(/(\))|([&\|,])?([\+\*\$\-:\w%\._]*)(\(?)/g,function(n,i,a,h,f){if(a&&("&"===a&&u("and"),"|"===a&&u("or")),f){var p=new t.Query;p.name=h,p.parent=l,s(p)}else if(i){var d=!l.name;if(l=l.parent,!l)throw new URIError("Closing paranthesis without an opening paranthesis");d&&l.args.push(l.args.pop().args)}else if((h||","===a)&&(l.args.push(r(h,o)),e(t.lastSeen,l.name)&&(c.cache[l.name]=l.args),"eq"===l.name&&l.args[0]===t.primaryKeyName)){var g=l.args[1];!g||g instanceof RegExp||(g=g.toString()),c.cache[t.primaryKeyName]=g}return""});if(l.parent)throw new URIError("Opening paranthesis without a closing paranthesis");if(f)throw new URIError("Illegal character in query string encountered "+f);return a(c),c}function r(e,n){var r=t.converters["default"];if("$"===e.charAt(0)){var i=parseInt(e.substring(1))-1;return i>=0&&n?n[i]:void 0}if(e.indexOf(":")>-1){var o=e.split(":",2);if(r=t.converters[o[0]],!r)throw new URIError("Unknown converter "+o[0]);e=o[1]}return r(e)}var i={"=":"eq","==":"eq",">":"gt",">=":"ge","<":"lt","<=":"le","!=":"ne"};t.primaryKeyName="id",t.lastSeen=["sort","select","values","limit"],t.jsonQueryCompatible=!0,t.parse=t.parseQuery=n,t.parseGently=function(){var e;try{e=n.apply(this,arguments)}catch(r){e=new t.Query,e.error=r.message}return e},t.commonOperatorMap={and:"&",or:"|",eq:"=",ne:"!=",le:"<=",ge:">=",lt:"<",gt:">"};var o=t.autoConverted={"true":!0,"false":!1,"null":null,undefined:void 0,Infinity:1/0,"-Infinity":-(1/0)};return t.converters={auto:function(e){if(o.hasOwnProperty(e))return o[e];var n=+e;return isNaN(n)||n.toString()!==e?(e=decodeURIComponent(e),t.jsonQueryCompatible&&"'"==e.charAt(0)&&"'"==e.charAt(e.length-1)?JSON.parse('"'+e.substring(1,e.length-1)+'"'):e):n},number:function(t){var e=+t;if(isNaN(e))throw new URIError("Invalid number "+e);return e},epoch:function(t){var e=new Date(+t);if(isNaN(e.getTime()))throw new URIError("Invalid date "+t);return e},isodate:function(e){var n="0000".substr(0,4-e.length)+e;return n+="0000-01-01T00:00:00Z".substring(n.length),t.converters.date(n)},date:function(t){var e=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(t);if(e?date=new Date(Date.UTC(+e[1],+e[2]-1,+e[3],+e[4],+e[5],+e[6])):date=new Date(t),isNaN(date.getTime()))throw new URIError("Invalid date "+t);return date},"boolean":function(t){return"true"===t},string:function(t){return decodeURIComponent(t)},re:function(t){return new RegExp(decodeURIComponent(t),"i")},RE:function(t){return new RegExp(decodeURIComponent(t))},glob:function(t){var e=decodeURIComponent(t).replace(/([\\|\||\(|\)|\[|\{|\^|\$|\*|\+|\?|\.|\<|\>])/g,function(t){return"\\"+t}).replace(/\\\*/g,".*").replace(/\\\?/g,".?");return e=".*"!==e.substring(0,2)?"^"+e:e.substring(2),".*"!==e.substring(e.length-2)?e+="$":e=e.substring(0,e.length-2),new RegExp(e,"i")}},t.converters["default"]=t.converters.auto,t.Query=function(){this.name="and",this.args=[]},t})},{"./util/contains":21}],21:[function(e,n,r){({define:"undefined"!=typeof t?t:function(t,e){n.exports=e(r)}}).define([],function(){function t(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return!0}return t})},{}],22:[function(t,e,n){!function(){"use strict";var n=t("elenpi/index"),r=n.r,i={i:function(t){var e=parseInt(t,10);return isNaN(e)||e===1/0?null:e},f:function(t){var e=parseFloat(t);return isNaN(e)||e===1/0?null:e},b:function(t){return"true"===t?!0:"false"===t?!1:null},q:function(t){return"?"!==t[0]?null:t},s:function(t){return"?"==t[0]?null:t}},o={disjonction:r().regExp(/^\[\s*/).oneOrMore("disjonction",r().rule("xpr"),r().regExp(/^\s*,\s*/)).regExp(/^\s*\]/),cast:r().regExp(/^([\w-_]+):/,!0,function(t,e){if(t.cast=i[e[1]],!t.cast)throw new Error("routes : no cast method as : "+e[1])}),end:r().regExp(/^\$/,!1,"end"),steps:r().zeroOrMore("steps",r().rule("xpr"),r().regExp(/^\//)),block:r().regExp(/^\(\s*/).rule("steps").regExp(/^\s*\)/),key:r().regExp(/^[0-9\w-_\.]+/,!1,"key"),xpr:r().oneOf(null,[r().regExp(/^\!/,!1,"not"),r().regExp(/^\?/,!1,"optional")],!0).oneOf(null,[r().rule("cast").rule("key"),"end","disjonction","block"]),route:r().regExp(/^\./,!0,"local").regExp(/^\//).rule("steps")},s=new n.Parser(o,"route"),u=function(t){};u.prototype.match=function(t){var e=!1;if(t.route.length>t.index)if(this.end)t.index===t.route.length&&(e=!0);else if(this.steps)e=this.steps.every(function(e){return e.match(t)});else if(this.disjonction)e=this.disjonction.some(function(e){return e.match(t)});else if(this.cast){var n=this.cast(t.route[t.index]);null!==n&&(t.output[this.key]=n,t.index++,e=!0)}else t.route[t.index]===this.key&&(t.index++,e=!0);if(this.not)e=!e;else if(!e&&this.optional)return!0;return e},s.createDescriptor=function(){return new u};var a=function(t){if(this.parsed=s.parse(t),!this.parsed)throw new Error("route could not be parsed : "+t)};a.prototype.match=function(t){if("string"==typeof t){var e=t.split("/");""===e[0]&&e.shift(),""===e[e.length-1]&&e.pop(),t={route:e,index:0,output:{}}}return this.parsed.match(t)?t:!1},e.exports=a}()},{"elenpi/index":18}],23:[function(t,e,n){!function(){"use strict";function n(t,e,n,i,o,s,u,a){Object.keys(t).forEach(function(l){t[l].__interpolable__&&t[l].subscribeTo(n,function(t,c,h){s&&s.call(e,n,i,o),n.setAsync(l,r.get(h)).then(function(t){u&&u.call(e,n,i,o)},function(t){if(a)return a.call(e,n,i,o,t);throw t})})})}var r=t("c3po"),i=(t("../lib/context"),t("../lib/view")),o=t("../lib/template"),s=t("../lib/interpolable").interpolable;i.prototype.load=o.prototype.load=function(t,e,i,o,u){var a,l,c,h;"string"==typeof t?(a=t,t={},t[a]=e,l=i,c=o,h=u):(l=e,c=i,h=o);for(var f in t)t[f]=s(t[f]);return this.exec(function(e,i,o){var s,u=this;n(t,this,e,i,o,l,c,h),l&&l.call(u,e,i,o);var a,f=[];for(var p in t)a=t[p].__interpolable__?t[p].output(e):t[p],f.push(e.setAsync(p,r.get(a)));s=1==f.length?f[0]:Promise.all(f),s.then(function(t){c&&c.call(u,e,i,o)},function(t){if(h)return h.call(u,e,i,o,t);throw t}),o.push(s)},!0)},e.exports=r}()},{"../lib/context":3,"../lib/interpolable":6,"../lib/template":12,"../lib/view":14,c3po:17}],24:[function(t,e,n){!function(){"use strict";function n(t,e){var n=!1;return t._routes.forEach(function(r){var i=r.match(e);i&&(t.set("$route",i.output),n=!0)}),n}function r(t,e){if(!t._routes){e=e||(o.isServer?null:window);var r=t;t._routes=[];var i=function(t){var e=window.history.location.relative;try{n(r,e)}catch(t){console.log("error on popstate : ",t,t.stack)}};e.addEventListener("popstate",i);var s=function(t){var e=window.history.location.relative;try{n(r,e)}catch(t){console.log("error on setstate : ",t,t.stack)}};e.addEventListener("setstate",s),t._binds.push(function(){e.removeEventListener("popstate",i),e.removeEventListener("setstate",s)})}}var i=t("routedsl"),o=t("../lib/utils"),s=t("../lib/context"),u=t("../lib/view"),a=t("../lib/template"),l=(t("../lib/interpolable"),{});a.prototype.route=function(t){return t=new i(t),this.exec(function(e){e.route(t)},!0)},l.navigateTo=function(t,e,n){o.isServer||window.history.pushState(n,e||"",t)},l.Route=i,s.prototype.route=u.prototype.route=function(t,e){return"string"==typeof t&&(t=new i(t)),this._routes||r(this,e),(this._routes=this._routes||[]).push(t),this},e.exports=l}()},{"../lib/context":3,"../lib/interpolable":6,"../lib/template":12,"../lib/utils":13,"../lib/view":14,routedsl:22}],25:[function(t,e,n){!function(){"use strict";var n=t("orql"),r=t("../lib/context"),i=t("../lib/view"),o=t("../lib/template"),s=t("../lib/interpolable");o.prototype.rqlView=function(t,e,n){return this.exec(function(r){r.rqlView(t,e,n)},!0)},i.prototype.rqlView=r.prototype.rqlView=function(t,e,r){r=s.interpolable(r),this.data[e]=[];var i=this;return this.subscribe(t,function(o,s,u,a){u="push"===o||"removeAt"===o?i.get(t):u;var l=n(u,r.__interpolable__?r.output(i):r);i.set(e,l)}),this.set(e,n(this.get(t),r.__interpolable__?r.output(i):r)),r.__interpolable__&&r.subscribeTo(this,function(r,o,s){i.set(e,n(i.get(t),s))}),this},e.exports=n}()},{"../lib/context":3,"../lib/interpolable":6,"../lib/template":12,"../lib/view":14,orql:19}],26:[function(t,e,n){!function(){"use strict";var n=t("aright"),r=t("../lib/context"),i=t("../lib/view"),o=t("../lib/template");o.prototype.validate=function(t,e){return this.exec(function(n){n.validate(t,e)},!0)},i.prototype.validate=r.prototype.validate=function(t,e){var n=this,r=function(t,r,i,o){var s;"push"===t?s=e.validate(n.get(r)):"removeAt"!==t&&(s=e.validate(i)),s!==!0?n.set("$error."+r,s):n.del("$error."+r)};this.subscribe(t,r);var i=this.get(t);return"undefined"!=typeof i&&r("set",t,i),this},e.exports=n}()},{"../lib/context":3,"../lib/template":12,"../lib/view":14,aright:16}]},{},[1])(1)});