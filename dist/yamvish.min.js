!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.y=t()}}(function(){var t;return function e(t,n,r){function i(s,u){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return i(n?n:e)},c,c.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){var r=t("./lib/utils"),i=function(t){return new i.Template(t)};i.isServer=r.isServer,i.utils=r,i.Context=t("./lib/context"),i.Template=t("./lib/template"),i.PureNode=t("./lib/pure-node"),i.Virtual=t("./lib/virtual"),i.Container=t("./lib/container"),i.View=t("./lib/view"),i.rql=t("./plugins/rql-array"),t("./plugins/rql");var o=t("./lib/interpolable");i.interpolable=o.interpolable,i.Interpolable=o.Interpolable,i.mainContext=null,i.components={},i.addComponent=function(t,e){i.components[t]=e},e.exports=i},{"./lib/container":2,"./lib/context":3,"./lib/interpolable":5,"./lib/pure-node":7,"./lib/template":8,"./lib/utils":9,"./lib/view":10,"./lib/virtual":11,"./plugins/rql":13,"./plugins/rql-array":12}],2:[function(t,e,n){function r(t){t=t||{},this.__yContainer__=!0,this.parent=t.parent,this.childNodes=[],o.call(this,t)}var i=t("./utils"),o=t("./pure-node"),s=t("./emitter");r.prototype={mount:function(t,e,n){if(this.destroyed)throw new Error("yamvish container has been destroyed. could not mount anymore.");if(t&&(t===this.mountPoint||t===this.mountSelector))return this;if(!this.childNodes)return this;var r=t;if("string"==typeof r&&(this.mountSelector=t,r=(n||i.domQuery)(t)),!r)throw new Error("yamvish : mount point not found : "+t);return this.mountPoint=r,e||i.emptyNode(r),i.mountChildren(this,r),(r._yamvish_containers=r._yamvish_containers||[]).push(this),this.dispatchEvent("mounted",this)},appendTo:function(t,e){return this.mount(t,"append",e)},unmount:function(){if(!this.mountPoint)return this;for(var t=0;t<this.childNodes.length;t++)this.mountPoint.removeChild(this.childNodes[t]);return this.mountPoint=null,this.mountSelector=null,this.dispatchEvent("unmounted",this)},destroy:function(){if(this.destroyed)return this;if(this.dispatchEvent("destroy",this),this.destroyed=!0,this.childNodes)for(var t=0;t<this.childNodes.length;t++)i.destroyElement(this.childNodes[t],!0);this.childNodes=void 0,this.context=void 0,this.mountPoint=void 0,this.mountSelector=void 0}},i.mergeProto(o.prototype,r.prototype),i.mergeProto(s.prototype,r.prototype),r.prototype.appendChild=function(t){return o.prototype.appendChild.call(this,t),this.mountPoint&&this.mountPoint.appendChild(t),t},r.prototype.removeChild=function(t){return this.childNodes?(o.prototype.removeChild.call(this,t),this.mountPoint&&this.mountPoint.removeChild(t),t):!1},e.exports=r},{"./emitter":4,"./pure-node":7,"./utils":9}],3:[function(t,e,n){function r(t){t=t||{},this.data=void 0!==t.data?t.data:{},this.parent=t.parent,this.handlers=t.handlers||{},this.map={},this.path=t.path;var e=this;this._binds=[],t.path&&this.parent&&this._binds.push(this.parent.subscribe(t.path,function(t,n,r){e.reset(r)}))}function i(t,e,n,r,i){for(var o=0,s=t._upstreams.length;s>o;++o)t._upstreams[o](e,n,r,i)}var o=t("./utils");r.prototype={destroy:function(){this._binds&&this._binds.forEach(function(t){t()}),this._binds=null,this.parent=null,this.data=null,this.handlers=null,this.map=null},reset:function(t){return this.data=t||{},this.notifyAll("reset",null,this.map,t,"*"),this},toggle:function(t){return this.set(t,!this.get(t)),this},set:function(t,e){if(t.forEach||(t=t.split(".")),"$this"===t[0])return this.reset(e);if("$parent"===t[0]){if(this.parent)return this.parent.set(t.slice(1),e);throw new Error("yamvish.Context : there is no parent in current context. could not find : "+t.join("."))}var n=o.setProp(this.data,t,e);return n!==e&&this.notify("set",t,e,t[t.length-1]),this},push:function(t,e){if(t.forEach||(t=t.split(".")),"$parent"==t[0]){if(this.parent)return this.parent.push(t.slice(1),e);throw new Error("yamvish.Context : there is no parent in current context. could not find : "+t.join("."))}var n;if(n="$this"===t[0]?this.data:o.getProp(this.data,t),!n)throw new Error("yamvish.Context : Missing array at "+t.join(".")+" : couldn't push object.");if(!n.forEach)throw new Error("yamvish.Context : Object is not array at "+t.join(".")+" : couldn't push object.");return n.push(e),this.notify("push",t,e,n.length-1),this},del:function(t){if(t=t.forEach?t.slice():t.split("."),"$parent"==t[0]){if(this.parent)return this.parent.del(t.slice(1));throw new Error("yamvish.Context : there is no parent in current context. could not find : "+t.join("."))}var e=t.pop(),n=t.length?o.getProp(this.data,t):this.data;if(n)if(n.forEach){var r=parseInt(e,10);n.splice(r,1),this.notify("removeAt",t,null,r)}else delete n[e],this.notify("delete",t,null,e);return this},get:function(t){if(t.forEach||(t=t.split(".")),"$this"===t[0])return this.data;if("$parent"==t[0]){if(this.parent)return this.parent.get(t.slice(1));throw new Error("yamvish.Context : there is no parent in current context. could not find : "+t.join("."))}return o.getProp(this.data,t)},subscribe:function(t,e,n){t.forEach||(t=t.split("."));var r;if("$this"===t[0])r=this.map;else{if("$parent"===t[0]){if(this.parent)return this.parent.subscribe(t.slice(1),e,n);throw new Error("yamvish.Context : there is no parent in current context. could not find : "+t.join("."))}r=o.getProp(this.map,t)}n?r?(r._upstreams=r._upstreams||[]).push(e):o.setProp(this.map,t,{_upstreams:[e]}):r?(r._listeners=r._listeners||[]).push(e):o.setProp(this.map,t,{_listeners:[e]});var i=this;return function(){i.unsubscribe(t,e,n)}},unsubscribe:function(t,e,n){t.forEach||(t=t.split("."));var r;if("$this"===t[0])r=this.map;else{if("$parent"===t[0]){if(this.parent)return this.parent.unsubscribe(t.slice(1),e,n),this;throw new Error("yamvish.Context : there is no parent in current context. could not find : "+t.join("."))}r=o.getProp(this.map,t)}if(!r)return this;for(var i=n?r._upstreams:r._listeners,s=0,u=i.length;u>s;++s)if(i[s]===e){i.splice(s,1);break}return this},notifyAll:function(t,e,n,r,i){if(n=n||this.map,r=arguments.length<2?this.data:r,n._listeners)for(var o=0,s=n._listeners.length;s>o;++o)n._listeners[o](t,e,r,i);if("push"!==t&&"removeAt"!==t)for(var u in n)"_listeners"!==u&&"_upstreams"!==u&&this.notifyAll(t,e,n[u],r?r[u]:void 0,i);return this},notify:function(t,e,n,r){e.forEach||(e=e.split(".")),"$this"===e[0]&&(e=[]);for(var o,s=this.map,u=0,a=e.length;a>u&&(o=s["*"],o&&o._upstreams&&i(o,t,e,n,r),s=s[e[u]]);++u)s._upstreams&&i(s,t,e,n,r);return o&&this.notifyAll(t,e,o,n,r),s&&this.notifyAll(t,e,s,n,r),this}},e.exports=r},{"./utils":9}],4:[function(t,e,n){var r=function(){};r.prototype={addEventListener:function(t,e){return this._events=this._events||{},(this._events[t]=this._events[t]||[]).push(e),this},removeEventListener:function(t,e){return this._events&&t in this._events!=!1?(this._events[t].splice(this._events[t].indexOf(e),1),this):this},dispatchEvent:function(t){if(!this._events||t in this._events==!1)return this;for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1));return this}},e.exports=r},{}],5:[function(t,e,n){function r(t){var e=t.split(o);return 1==e.length?t:new i(e)}var i=function(t){if(this.__interpolable__=!0,3===t.length&&""===t[0]&&""===t[2])this.directOutput=t[1],this.dependencies=[t[1]];else{this.splitted=t,this.dependencies=[];for(var e=1,n=t.length;n>e;e+=2)this.dependencies.push(t[e])}};i.prototype={subscribeTo:function(t,e){for(var n=[],r=this,i=0,o=this.dependencies.length;o>i;++i)n.push(t.subscribe(this.dependencies[i],function(n,i,o){e(n,i,r.directOutput?o:r.output(t))}));return 1==n.length?n[0]:function(){for(var t=0;t<n.length;t++)n[t]()}},output:function(t){if(this.directOutput)return t.get(this.directOutput);for(var e="",n=!0,r=0,i=this.splitted.length;i>r;++r)e+=n?this.splitted[r]:t.get(this.splitted[r]),n=!n;return e}};var o=/\{\{\s*([^\}\s]+)\s*\}\}/;e.exports={interpolable:r,Interpolable:i}},{}],6:[function(t,e,n){function r(t,e){for(var n=e||new this.Template,r=0,o=t.childNodes.length;o>r;++r)i(t.childNodes[r],n);return n}function i(t,e){var n=e||y();switch(t.nodeType){case 1:var i=new this.Template;if(r(t,i),t.id&&i.id(t.id),t.attributes.length)for(var o=0,s=t.attributes.length;s>o;++o){var u=t.attributes[o];i.attr(u.name,u.value)}for(var a=0;a<t.classList;++a)i.setClass(t.classList[a]);n.tag.apply(n,[t.tagName.toLowerCase(),i]);break;case 3:n.text(t.textContent);break;case 4:console.log("element is CDATA : ",t);break;default:console.warn("y.elementToTemplate : DOM node not managed : type : %s, ",t.nodeType,t)}return n}e.exports={elementChildrenToTemplate:r,elementToTemplate:i}},{}],7:[function(t,e,n){function r(){this.__yPureNode__=!0}t("./utils");r.prototype={insertBefore:function(t,e){var n=this.childNodes.indexOf(e);return-1==n?!1:(0==n?this.childNodes.unshift(t):this.childNodes.splice(n,0,t),!0)},appendChild:function(t){return(this.childNodes=this.childNodes||[]).push(t),t.parentNode=this,t},removeChild:function(t){if(!this.childNodes)return!1;for(var e=0,n=this.childNodes.length;n>e;++e)if(this.childNodes[e]===t)return t.parentNode=null,this.childNodes.splice(e,1),t;return!1},toString:function(){if(!this.childNodes)return"";for(var t="",e=0,n=this.childNodes.length;n>e;++e)t+=this.childNodes[e].toString();return t}},e.exports=r},{"./utils":9}],8:[function(t,e,n){!function(){"use strict";function n(){this.attributes="",this.classes="",this.children="",this.style=""}function r(t){t?(this._queue=t._queue.slice(),this._hasEach=t._hasEach):this._queue=[]}function i(t,e,n,r){try{return e.call(t,t.context||n,r)}catch(i){return i}}function o(t,e,n,r,o){for(var s,u=e[0],a=0;u;){if(a++,o){if("catch"!==u.type||!u.toElement){u=e[a];continue}s=i(t,u.toElement,n,r),o=null}else{if("catch"===u.type||!u.toElement){u=e[a];continue}s=i(t,u.toElement,n,r)}s instanceof Error&&(o=s),u=e[a]}return o&&console.error("y.Template exec error : ",o,o.stack),o||s}var s=t("./utils"),u=t("./interpolable").interpolable,a=(t("./parsers/dom-to-template"),t("./virtual")),l=t("./pure-node"),c=t("./container"),h=t("./context"),f=function(){return new r},d=function(t,e){if(e=e||t._eachTemplate,!e)throw s.produceError("no template for .each template handler",t);return e};r.prototype={call:function(t,e,n){return o(t,this._queue,e,n||(s.isServer?a:document))},toElement:function(t,e){{var n=new c({factory:e});o(n,this._queue,t,e||(s.isServer?a:document))}return n},toString:function(t,e){e=e||new n;for(var r=0,i=this._queue.length;i>r;++r)this._queue[r].toString&&this._queue[r].toString(t,e);return e.children},done:function(t,e){return this._queue.push({type:"done",toElement:t,toString:e===!0?t:e}),this},"catch":function(t,e){return this._queue.push({type:"catch",toElement:t,toString:e===!0?t:e}),this},"if":function(t,e,n){var r=typeof t;return"string"===r&&(t=u(t)),this.done(function(i,o){var s=t,u=this,a=function(t,r,s){return s?e.call(u,i,o):n?n.call(u,i,o):void 0};return t&&t.__interpolable__?(s=t.output(i),(this._binds=this._binds||[]).push(t.subscribeTo(i,a))):"function"===r&&(s=t.call(this,i)),a("set",s)},function(i,o){var s;return t&&t.__interpolable__?s=t.output(i):"function"===r&&(s=t.call(this,i)),s?e.toString(i,o):n?n.toString(i,o):void 0})},set:function(t,e){return this.done(function(n){if(n=n||this.context,!n)throw s.produceError("no context avaiable to set variable in it. aborting.",this);n.set(t,e)},!0)},push:function(t,e){return this.done(function(n){n.push(t,e)},!0)},del:function(t){return this.done(function(e){e.del(t)},!0)},setHandler:function(t,e){return this.done(function(n){(n.handlers=n.handlers||{})[t]=e})},context:function(t){var e;return"string"==typeof t&&(e=t),this.done(function(n){this.context=new h({data:e?null:t,parent:n,path:e?e:null})},!0)},sub:function(t,e,n){return this.done(function(r){r.subscribe(t,e,n)})},unsub:function(t,e,n){return this.done(function(r){r.unsubscribe(t,e,n)})},"with":function(t,e){return this.done(function(n,r){var i=new h({data:"string"==typeof t?n.get(t):t,parent:n,path:t});e.call(this,i,r)},function(t,r){var i=new n;e.toString(t,i),r.attributes+=i.attributes,i.style&&(r.style+=i.style),i.classes&&(r.classes+=i.classes),i.children&&(r.children+=i.children)})},attr:function(t,e){return"string"==typeof e&&(e=u(e)),(this._attributes=this._attributes||[]).push({name:t,value:e}),this.done(function(n){var r=this,i=e;e.__interpolable__&&(i=e.output(n),(this._binds=this._binds||[]).push(e.subscribeTo(n,function(e,n,i){r.setAttribute(t,i)}))),this.setAttribute(t,i)},function(n,r){return r.attributes+=" "+t,e&&(r.attributes+='="'+(e.__interpolable__?e.output(n):e)+'"'),""})},removeAttr:function(t){return this.done(function(e){this.removeAttribute(t)},function(t,e){})},disabled:function(t){return this.done(function(e){var n=this,r=function(t,e,r){r?n.setAttribute("disabled"):n.removeAttribute("disabled")};"string"==typeof t?((this._binds=this._binds||[]).push(e.subscribe(t,r)),r("set",null,e.get(t))):r("set",null,void 0!==t?t:!0)},function(e,n){(void 0===t||e.get(t))&&(n.attributes+=" disabled")})},val:function(t){return"string"==typeof t&&(t=u(t)),this.done(function(e){var n=this;t.__interpolable__?(s.isServer||this.addEventListener("input",function(n){e.set(t.directOutput,n.target.value)}),(this._binds=this._binds||[]).push(t.subscribeTo(e,function(t,e,r){n.setAttribute("value",r)})),this.setAttribute("value",e.get(t.directOutput))):this.setAttribute("value",t)},function(e,n){n.attributes+=' value="'+(t.__interpolable__?t.output(e):t)+'"'})},contentEditable:function(t){return"string"==typeof t&&(t=u(t)),this.done(function(e,n){var r,i,o=this;this.setAttribute("contenteditable",!0),t.__interpolable__?(i=e.get(t.directOutput),s.isServer||this.addEventListener("input",function(n){o.freeze=!0,e.set(t.directOutput,n.target.textContent)}),(this._binds=this._binds||[]).push(t.subscribeTo(e,function(t,e,n){o.freeze||(o.nodeValue=n,o.el&&(o.el.nodeValue=n)),o.freeze=!1}))):i=t,r=n.createTextNode(i),this.appendChild(r)},function(t,e){e.attributes+=" contenteditable"})},setClass:function(t,e){return this.done(function(n){function r(e,n,r){r?s.setClass(i,t):s.removeClass(i,t)}var i=this;void 0!==e?"string"==typeof e?((this._binds=this._binds||[]).push(n.subscribe(e,r)),r("set",null,n.get(e))):r("set",null,e):r("set",null,!0)},function(n,r){(void 0===e||n.get(e))&&(r.classes+=" "+t)})},css:function(t,e){return"string"==typeof e&&(e=u(e)),this.done(function(n){var r=e,i=this;e.__interpolable__&&(r=e.output(n),(this._binds=this._binds||[]).push(e.subscribeTo(n,function(e,n,r){i.style[t]=r}))),(this.style=this.style||{})[t]=r},function(n,r){r.style+=t+":"+(e.__interpolable__?e.output(n):e)})},visible:function(t){return this.done(function(e){var n=t,r=this,i=(this.style?this.style.display:"block")||"block";this.style||(this.style={}),"string"==typeof t&&(n=e.get(t),(this._binds=this._binds||[]).push(e.subscribe(t,function(t,e,n){r.style.display=n?i:"none"}))),this.style.display=n?i:"none"},function(e,n){var r="string"==typeof t?e.get(t):t;r||(n.style+="display:none;")})},text:function(t){return"string"==typeof t&&(t=u(t)),this.done(function(e,n){var r;t.__interpolable__?(r=n.createTextNode(t.output(e)),(this._binds=this._binds||[]).push(t.subscribeTo(e,function(t,e,n){r.__yVirtual__&&(r.nodeValue=n,r.el&&(r.el.nodeValue=n)),r.nodeValue=n}))):r=n.createTextNode(t),this.appendChild(r)},function(e,n){n.children+=t.__interpolable__?t.output(e):t})},tag:function(t){for(var e=[],r=1,i=arguments.length;i>r;++r)e.push(arguments[r].call?arguments[r]:f().text(arguments[r]));return this.done(function(n,r){for(var i,o=r.createElement(t),s=[],u=0,a=e.length;a>u;++u)i=e[u].call(o,this.childrenContext||n,r),i&&i.then&&s.push(i);return this.appendChild(o),s.length?Promise.all(s):void 0},function(r,i){var o="<"+t;this._id&&(o+=' id="'+this._id+'"');for(var s=new n,u=0,a=e.length;a>u;u++)e[u].toString&&e[u].toString(r,s);o+=s.attributes,s.style&&(o+=' style="'+s.style+'"'),s.classes&&(o+=' class="'+s.classes+'"'),s.children?i.children+=o+">"+s.children+"</"+t+">":i.children+=o+"/>"})},a:function(t){var e=Array.prototype.slice.call(arguments,1);return e.unshift("a",f().attr("href",t)),this.tag.apply(this,e)},input:function(t,e){var n=Array.prototype.slice.call(arguments,2),r=f().attr("type",t);return e&&r.val(e),n.unshift("input",r),this.tag.apply(this,n)},h:function(t){var e=Array.prototype.slice.call(arguments,1);return e.unshift("h"+t),this.tag.apply(this,e)},on:function(t,e){return this.done(function(n){if(!s.isServer){var r;if("string"==typeof e){if(!n.handlers||!n.handlers[e])throw s.produceError("on("+t+') : no "'+e+'" handlers define in current context',this);r=n.handlers[e]}else r=e;this.addEventListener(t,function(t){return r.call(n,t)})}})},off:function(t,e){return this.done(function(){this.removeEventListener(t,e)})},each:function(t,e){return this._hasEach=!0,this.done(function(n,r){function i(t,e){var i=new h({data:t,parent:n}),c=new l;c.context=i,a.childNodes.push(c),u.call(c,i,r),o.__yPureNode__&&!o.mountPoint||!c.childNodes||s.mountChildren(c,o.mountPoint||o,e)}var o=this,u=d(this,e),a=new l;a.childNodes=[],this.__yPureNode__?this.appendChild(a):(this._yamvish_containers=this._yamvish_containers||[]).push(a);var c=function(t,e,n,r){switch(e.forEach&&(e=e.join(".")),t){case"reset":case"set":for(var u=0,l=!o.__yPureNode__||o.mountPoint?s.findNextSibling(a):null,c=n.length;c>u;++u)a.childNodes[u]?a.childNodes[u].context.reset(n[u]):i(n[u],l);if(u<a.childNodes.length){for(var h=u,f=a.childNodes.length;f>u;++u)s.destroyElement(a.childNodes[u],!0);a.childNodes.splice(h)}break;case"removeAt":s.destroyElement(a.childNodes[r],!0),a.childNodes.splice(r,1);break;case"push":i(n,!o.__yPureNode__||o.mountPoint?s.findNextSibling(a):null)}},f=t;return"string"==typeof t&&((this._binds=this._binds||[]).push(n.subscribe(t,c)),(this._binds=this._binds||[]).push(n.subscribe(t+".*",function(t,e,n,r){var i=a.childNodes[r];i&&i.context.reset(n)})),f=n.get(t)),f?c("set",t,f):void 0},function(r,i){var o=d(this,e),s=new n,u="string"==typeof t?r.get(t):t;if(u)for(var a=0,l=u.length;l>a;++a)o.toString(new h({data:u[a],parent:r}),s);i.children+=s.children})},from:function(t){return this.done(function(t,e,n){},function(t,e,n){})}},["div","span","ul","li","button","p"].forEach(function(t){r.prototype[t]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift(t),this.tag.apply(this,e)}}),["click","blur","focus"].forEach(function(t){r.prototype[t]=function(e){return this.on(t,e)}}),e.exports=r}()},{"./container":2,"./context":3,"./interpolable":5,"./parsers/dom-to-template":6,"./pure-node":7,"./utils":9,"./virtual":11}],9:[function(t,e,n){function r(t,e){var n=new Error(t);return n.report=e,n}function i(t,e){t.__yVirtual__?(t.el&&t.el.classList.add(e),(t.classes=t.classes||{})[e]=!0):t.classList.add(e)}function o(t,e){t.__yVirtual__?(t.el&&t.el.classList.remove(e),t.classes&&delete t.classes[e]):t.classList.remove(e)}function s(t,e){if("$this"===e[0])return t;for(var n=t,r=0,i=e.length;i>r;++r)if(!n||void 0===(n=n[e[r]]))return;return n}function u(t,e){var n=t,r=0;for(len=e.length-1;r<len;++r)if(n&&!(n=n[e[r]]))return;n&&delete n[e[r]]}function a(t,e,n){for(var r,i=t,o=0,s=e.length-1;s>o;++o)i=i&&!i[e[o]]?i[e[o]]={}:i[e[o]];return i&&(r=i[e[o]],i[e[o]]=n),r}function l(t){if(t.childNodes&&t.childNodes.length){for(var e=0,n=t.childNodes.length;n>e;++e)c(t.childNodes[e]);t.__yVirtual__?t.childNodes=[]:t.innerHTML=""}}function c(t,e){if(e&&t.parentNode&&(t.parentNode.removeChild(t),t.parentNode=null),t.__yPureNode__?(t.__yVirtual__&&(t.attributes=void 0,t.listeners=void 0,t.classes=void 0,t.style=void 0),t.childNodes&&t.childNodes.length&&h(t,e)):t.childNodes&&t.childNodes.length&&h(t),t._binds){for(var n=0,r=t._binds.length;r>n;n++)t._binds[n]();t._binds=null}t._yamvish_containers&&(t._yamvish_containers=null)}function h(t,e){if(t.childNodes)for(var n=0;n<t.childNodes.length;n++)c(t.childNodes[n],e)}function f(t,e){for(var n in t)e[n]=t[n]}function d(t,e,n){try{return e.call(t,t.context||n)}catch(r){return r}}function p(t,e,n,r){for(var i,o=e[0],s=0;o;){if(s++,r){if("catch"!==o.type){o=e[s];continue}i=d(t,o.fn,n,r),r=null}else{if("catch"===o.type){o=e[s];continue}if(i=d(t,o.fn,n),i&&i.then){var u=e.slice(s);return i.then(function(e){return p(t,u,n)},function(e){return p(t,u,n,e)})}}i instanceof Error&&(r=i),o=e[s]}return r&&console.error("has error : ",r,r.stack),r||i}function v(t,e,n){if(t.childNodes&&t.__yPureNode__)if(n)for(var r=t.childNodes.length-1;r>=0;--r){var i=t.childNodes[r];i.__yPureNode__&&!i.__yVirtual__?v(i,e,n):e.insertBefore(i,n)}else for(var o=0,s=t.childNodes.length;s>o;++o){var i=t.childNodes[o];i.__yPureNode__&&!i.__yVirtual__?v(i,e):e.appendChild(i)}}function g(t){for(var e=t;e&&!e.__yVirtual__&&e.__yPureNode__&&e.childNodes&&e.childNodes.length;)e=e.childNodes[e.childNodes.length-1];return!e||e.__yPureNode__&&!e.__yVirtual__?null:e.nextSibling}e.exports={isServer:"undefined"==typeof window&&"undefined"==typeof document,mountChildren:v,execHandler:d,execQueue:p,mergeProto:f,destroyElement:c,destroyChildren:h,setProp:a,deleteProp:u,getProp:s,emptyNode:l,produceError:r,setClass:i,removeClass:o,findNextSibling:g,merge:function(t,e){var n={};for(var r in t)n[r]=t[r];for(var i in e)n[i]=e[i];return n},domQuery:function(t){return"#"===t[0]?document.getElementById(t.substring(1)):document.querySelector(t)}}},{}],10:[function(t,e,n){var r=t("./utils"),i=t("./template"),o=t("./virtual"),s=t("./container"),u=t("./context"),a=function(t){t=t||{},t.componentName&&addComponent(t.componentName,this),this.factory=t.factory,u.call(this,t),s.call(this,t)};r.mergeProto(i.prototype,a.prototype),r.mergeProto(u.prototype,a.prototype),r.mergeProto(s.prototype,a.prototype),a.prototype.done=function(t){return t.call(this,this,this.factory||(r.isServer?o:document)),this},a.prototype.destroy=function(){s.prototype.destroy.call(this),u.prototype.destroy.call(this)},delete a.prototype["catch"],delete a.prototype.call,delete a.prototype.toElement,delete a.prototype.id,delete a.prototype.attr,delete a.prototype.setClass,delete a.prototype.visible,delete a.prototype.css,delete a.prototype.val,delete a.prototype.contentEditable,e.exports=a},{"./container":2,"./context":3,"./template":8,"./utils":9,"./virtual":11}],11:[function(t,e,n){function r(t){t=t||{},this.__yVirtual__=!0,t.tagName&&(this.tagName=t.tagName),t.nodeValue&&(this.nodeValue=t.nodeValue),s.call(this,t)}var i=t("./utils"),o=t("./emitter"),s=t("./pure-node"),u=/(br|input|img|area|base|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)/;r.prototype={setAttribute:function(t,e){(this.attributes=this.attributes||{})[t]=e},removeAttribute:function(t,e){this.attributes&&delete this.attributes[t]}},i.mergeProto(s.prototype,r.prototype),i.mergeProto(o.prototype,r.prototype),r.prototype.toString=function(){if("textnode"===this.tagName)return this.nodeValue;var t="<"+this.tagName;this.id&&(t+=' id="'+this.id+'"');for(var e in this.attributes)t+=" "+e+'="'+this.attributes[e]+'"';if(this.classes){var n=Object.keys(this.classes);n.length&&(t+=' class="'+n.join(" ")+'"')}if(this.childNodes&&this.childNodes.length){t+=">";for(var r=0,i=this.childNodes.length;i>r;++r)t+=this.childNodes[r].toString();t+="</"+this.tagName+">"}else t+=this.scriptContent?">"+this.scriptContent+"</script>":u.test(this.tagName)?">":" />";return t},r.createElement=function(t){return new r({tagName:t})},r.createTextNode=function(t){return new r({tagName:"textnode",nodeValue:t})},e.exports=r},{"./emitter":4,"./pure-node":7,"./utils":9}],12:[function(t,e,n){!function(){"use strict";function n(t,e){if(!e||!e.forEach)return!1;if(t.forEach){var n={};e.forEach(function(t){n[t]=!0});var r=0;return t.forEach(function(t){n[t]&&r++}),r==t.length?!0:!1}return e.some(function(e){return t===e})}function r(t){if("object"==typeof t){var e=t.name,n=t.args;if(t.forEach)return t.map(r);var o=n[0],s=null;2==n.length&&(s=o,o=n[1]);var u=null,a=!1;switch(e){case"eq":a=!0,u=function(t){return(i(t,s)||void 0)===o};break;case"ne":a=!0,u=function(t){return(i(t,s)||void 0)!==o};break;case"le":a=!0,u=function(t){return(i(t,s)||void 0)<=o};break;case"ge":a=!0,u=function(t){return(i(t,s)||void 0)>=o};break;case"lt":a=!0,u=function(t){return(i(t,s)||void 0)<o};break;case"gt":a=!0,u=function(t){return(i(t,s)||void 0)>o};break;default:var l=h.ops[e];if(!l)throw new Error("RQLError : no operator found in rql with : "+e);n&&n.length>0?(n=n.map(r),u=function(){return l.apply(this,n)}):u=function(){return l.call(this)}}return a?function(){var t=this.filter(u);return t}:u}return t}function i(t,e){if(!e)return t;var n=e.split("."),r=t;if(!r)return r;var i=n.length;if(5>i){var o;switch(i){case 1:o=r[n[0]];break;case 2:o=r[n[0]]&&r[n[0]][n[1]];break;case 3:o=r[n[0]]&&r[n[0]][n[1]]&&r[n[0]][n[1]][n[2]];break;case 4:o=r[n[0]]&&r[n[0]][n[1]]&&r[n[0]][n[1]][n[2]]&&r[n[0]][n[1]][n[2]][n[3]]}return o}if(r=r[n[0]]&&r[n[0]][n[1]]&&r[n[0]][n[1]][n[2]]&&r[n[0]][n[1]][n[2]][n[3]],"undefined"==typeof r)return void 0;for(var s=4,u=n[s];u&&r[u];)r=r[u],u=n[++s];return s===i?r:void 0}function o(t,e){var n=function(e,n){"undefined"==typeof n&&(n=e,e=void 0);for(var r=(arguments,[]),i=0,o=this.length;o>i;i++){var s=this[i];t(u(s,e),n)&&r.push(s)}return r};return n.condition=t,n}function s(t){return function(e){return e?this.map(function(t){return i(t,e)}).reduce(t):this.reduce(t)}}function u(t,e){return e&&e.forEach?i(t,decodeURIComponent(e)):"undefined"==typeof e?i(t):i(t,decodeURIComponent(e))}var a=t("rql/parser"),l=a.parseQuery,c={},h=function(t,e){return"?"==e[0]&&(e=e.substring(1)),c[e]?c[e].call(t):h.compile(e).call(t)};h.parse=function(t){try{var e=l(t);return e.toString=function(){return t},e}catch(n){return null}},h.compile=function(t){var e=h.parse(t),n=r(e);return c[t]=n,n},h.ops={isPresent:function(t,e){for(var n=[],r=e.length,o=0;r>o;++o)i(e[o],t)&&n.push(e[o]);return n},sort:function(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e],r=n.charAt(0),o={attribute:n,ascending:!0};("-"==r||"+"==r)&&("-"==r&&(o.ascending=!1),o.attribute=o.attribute.substring(1)),t.push(o)}return this.sort(function(e,n){for(var r,o=0;r=t[o];o++){var s=i(e,r.attribute),u=i(n,r.attribute);if(s!=u)return r.ascending==s>u?1:-1}return 0}),this},match:o(function(t,e){return new RegExp(e).test(t)}),"in":o(function(t,e){for(var n=!1,r=0;!n&&r<e.length;)e[r++]==t&&(n=!0);return n}),out:o(function(t,e){for(var n=!0,r=0;n&&r<e.length;)e[r++]==t&&(n=!1);return n}),contains:o(function(t,e){return n(e,t)}),excludes:o(function(t,e){return!n(e,t)}),or:function(){for(var t=[],e=0;e<arguments.length;++e){var n=arguments[e];t=t.concat("function"==typeof n?n.call(this):h.ops.isPresent(n,t))}return t},and:function(){for(var t=this,e=0;e<arguments.length;++e){var n=arguments[e];t="function"==typeof n?n.call(t):h.ops.isPresent(n,t)}return t},select:function(){var t=arguments,e=arguments.length,n=this.map(function(n){for(var r={},i=0;e>i;i++){var o=t[i],s=u(n,o);"undefined"!=typeof s&&(r[o]=s)}return r});return n},unselect:function(){var t=arguments,e=arguments.length;return this.map(function(n){var r={};for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i]);for(var i=0;e>i;i++)delete r[t[i]];return r})},values:function(t){if(1==arguments.length)return this.map(function(e){return i(e,t)});var e=arguments,n=arguments.length;return this.map(function(t){var r=i(t),o=[];if(0===n)for(var s in r)r.hasOwnProperty(s)&&o.push(r[s]);else for(var s=0;n>s;s++){var u=e[s];o.push(r[u])}return o})},limit:function(t,e,n){var r=this.length;e=e||0;var i=this.slice(e,e+t);return n&&(i.start=e,i.end=e+i.length-1,i.totalCount=Math.min(r,"number"==typeof n?n:1/0)),i},distinct:function(){var t={},e=[],n=this.filter(function(n){return n=i(n),n&&"object"==typeof n?n.__found__?!1:(n.__found__=function(){},e.push(n),!0):t[n]?!1:(t[n]=!0,!0)});return e.forEach(function(t){delete t.__found__}),n},recurse:function(t){function e(r){if(r.forEach)r.forEach(e);else if(n.push(r),t)r=r[t],r&&"object"==typeof r&&e(r);else for(var i in r)r[i]&&"object"==typeof r[i]&&e(r[i])}var n=[];return e(i(this)),n},aggregate:function(){for(var t=[],e=[],n=0;n<arguments.length;n++){var r=arguments[n];"function"==typeof r?e.push(r):t.push(r)}var o={},s=t.length;this.forEach(function(e){e=i(e);for(var n="",r=0;s>r;r++)n+="/"+e[t[r]];var u=o[n];u||(u=o[n]=[]),u.push(e)});var u=e.length,a=[];for(var l in o){for(var c=o[l],h={},n=0;s>n;n++){var f=t[n];h[f]=c[0][f]}for(var n=0;u>n;n++){var d=e[n];h[n]=d.call(c)}a.push(h)}return a},between:o(function(t,e){return t=i(t),t>=e[0]&&t<e[1]}),sum:s(function(t,e){return t=i(t),e=i(e),t+e}),mean:function(t){return h.ops.sum.call(this,t)/this.length},max:s(function(t,e){return t=i(t),e=i(e),Math.max(t,e)}),min:s(function(t,e){return t=i(t),e=i(e),Math.min(t,e)}),count:function(){return this.length},first:function(){return this[0]},last:function(){return this[this.length-1]},random:function(){return this[Math.round(Math.random()*(this.length-1))]},one:function(){if(this.length>1)throw new Error("RQLError : More than one object found");return this[0]}},e.exports=h}()},{"rql/parser":14}],13:[function(t,e,n){!function(){"use strict";var e=t("./rql-array"),n=t("../lib/context"),r=t("../lib/view"),i=t("../lib/template"),o=t("../lib/interpolable");i.prototype.rqlView=function(t,e,n){return this.done(function(r){r.rqlView(t,e,n)},!0)},r.prototype.rqlView=n.prototype.rqlView=function(t,n,r){r=o.interpolable(r),this.data[n]=[];var i=this;return this.subscribe(t,function(o,s,u,a){u="push"===o||"removeAt"===o?i.get(t):u;var l=e(u,r.__interpolable__?r.output(i):r);i.set(n,l)}),this.set(n,e(this.get(t),r.__interpolable__?r.output(i):r)),r.__interpolable__&&r.subscribeTo(this,function(r,o,s){i.set(n,e(i.get(t),s))}),this}}()},{"../lib/context":3,"../lib/interpolable":5,"../lib/template":8,"../lib/view":10,"./rql-array":12}],14:[function(e,n,r){({define:"undefined"!=typeof t?t:function(t,i){n.exports=i(r,e("./util/contains"))}}).define(["exports","./util/contains"],function(t,e){function n(n,o){function s(n){l.args.push(n),l=n,e(t.lastSeen,l.name)&&(c.cache[l.name]=l.args)}function u(t){if(l.name){if(l.name!==t)throw new Error("Can not mix conjunctions within a group, use paranthesis around each set of same conjuctions (& and |)")}else l.name=t}function a(t){if(t&&t.args){delete t.parent;for(var e=t.args,n=0,r=e.length;r>n;n++)a(e[n])}return t}("undefined"==typeof n||null===n)&&(n="");var l=new t.Query,c=l;if(c.cache={},"object"==typeof n){if(n instanceof t.Query)return n;for(var h in n){var l=new t.Query;c.args.push(l),l.name="eq",l.args=[h,n[h]]}return c}if("?"==n.charAt(0))throw new URIError("Query must not start with ?");t.jsonQueryCompatible&&(n=n.replace(/%3C=/g,"=le=").replace(/%3E=/g,"=ge=").replace(/%3C/g,"=lt=").replace(/%3E/g,"=gt=")),n.indexOf("/")>-1&&(n=n.replace(/[\+\*\$\-:\w%\._]*\/[\+\*\$\-:\w%\._\/]*/g,function(t){return"("+t.replace(/\//g,",")+")"})),n=n.replace(/(\([\+\*\$\-:\w%\._,]+\)|[\+\*\$\-:\w%\._]*|)([<>!]?=(?:[\w]*=)?|>|<)(\([\+\*\$\-:\w%\._,]+\)|[\+\*\$\-:\w%\._]*|)/g,function(t,e,n,r){if(n.length<3){if(!i[n])throw new URIError("Illegal operator "+n);n=i[n]}else n=n.substring(1,n.length-1);return n+"("+e+","+r+")"}),"?"==n.charAt(0)&&(n=n.substring(1));var f=n.replace(/(\))|([&\|,])?([\+\*\$\-:\w%\._]*)(\(?)/g,function(n,i,a,h,f){if(a&&("&"===a&&u("and"),"|"===a&&u("or")),f){var d=new t.Query;d.name=h,d.parent=l,s(d)}else if(i){var p=!l.name;if(l=l.parent,!l)throw new URIError("Closing paranthesis without an opening paranthesis");

p&&l.args.push(l.args.pop().args)}else if((h||","===a)&&(l.args.push(r(h,o)),e(t.lastSeen,l.name)&&(c.cache[l.name]=l.args),"eq"===l.name&&l.args[0]===t.primaryKeyName)){var v=l.args[1];!v||v instanceof RegExp||(v=v.toString()),c.cache[t.primaryKeyName]=v}return""});if(l.parent)throw new URIError("Opening paranthesis without a closing paranthesis");if(f)throw new URIError("Illegal character in query string encountered "+f);return a(c),c}function r(e,n){var r=t.converters["default"];if("$"===e.charAt(0)){var i=parseInt(e.substring(1))-1;return i>=0&&n?n[i]:void 0}if(e.indexOf(":")>-1){var o=e.split(":",2);if(r=t.converters[o[0]],!r)throw new URIError("Unknown converter "+o[0]);e=o[1]}return r(e)}var i={"=":"eq","==":"eq",">":"gt",">=":"ge","<":"lt","<=":"le","!=":"ne"};t.primaryKeyName="id",t.lastSeen=["sort","select","values","limit"],t.jsonQueryCompatible=!0,t.parse=t.parseQuery=n,t.parseGently=function(){var e;try{e=n.apply(this,arguments)}catch(r){e=new t.Query,e.error=r.message}return e},t.commonOperatorMap={and:"&",or:"|",eq:"=",ne:"!=",le:"<=",ge:">=",lt:"<",gt:">"};var o=t.autoConverted={"true":!0,"false":!1,"null":null,undefined:void 0,Infinity:1/0,"-Infinity":-(1/0)};return t.converters={auto:function(e){if(o.hasOwnProperty(e))return o[e];var n=+e;return isNaN(n)||n.toString()!==e?(e=decodeURIComponent(e),t.jsonQueryCompatible&&"'"==e.charAt(0)&&"'"==e.charAt(e.length-1)?JSON.parse('"'+e.substring(1,e.length-1)+'"'):e):n},number:function(t){var e=+t;if(isNaN(e))throw new URIError("Invalid number "+e);return e},epoch:function(t){var e=new Date(+t);if(isNaN(e.getTime()))throw new URIError("Invalid date "+t);return e},isodate:function(e){var n="0000".substr(0,4-e.length)+e;return n+="0000-01-01T00:00:00Z".substring(n.length),t.converters.date(n)},date:function(t){var e=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(t);if(e?date=new Date(Date.UTC(+e[1],+e[2]-1,+e[3],+e[4],+e[5],+e[6])):date=new Date(t),isNaN(date.getTime()))throw new URIError("Invalid date "+t);return date},"boolean":function(t){return"true"===t},string:function(t){return decodeURIComponent(t)},re:function(t){return new RegExp(decodeURIComponent(t),"i")},RE:function(t){return new RegExp(decodeURIComponent(t))},glob:function(t){var e=decodeURIComponent(t).replace(/([\\|\||\(|\)|\[|\{|\^|\$|\*|\+|\?|\.|\<|\>])/g,function(t){return"\\"+t}).replace(/\\\*/g,".*").replace(/\\\?/g,".?");return e=".*"!==e.substring(0,2)?"^"+e:e.substring(2),".*"!==e.substring(e.length-2)?e+="$":e=e.substring(0,e.length-2),new RegExp(e,"i")}},t.converters["default"]=t.converters.auto,t.Query=function(){this.name="and",this.args=[]},t})},{"./util/contains":15}],15:[function(e,n,r){({define:"undefined"!=typeof t?t:function(t,e){n.exports=e(r)}}).define([],function(){function t(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return!0}return t})},{}]},{},[1])(1)});