<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>yamvish tests</title>
    <script type="text/javascript" src="./dist/yamvish.js"></script>
</head>

<body>
    <div>
        <button onclick="test.dom()">dom</button>
        <button onclick="test.string()">string</button>
        <button onclick="test.twopass2()">twopass</button>
        <span id="res"></span>
    </div>
    <div id="app"></div>
    <script type="text/javascript">
    function range(size) {
        var output = [];
        for (var i = 0; i < size; ++i)
            output.push(Math.random() + "");
        return output;
    }

    //_____________________________________ STRING

    var t = y()
        .set('world', 'yamvish')
        .set('title', 'wuuu')
        .set('items', range(200))
        .div('hello {{ world }}')
        .div('title {{ title }}')
        .p('____')
        .div(
            y().each(
                'items',
                y().p('{{ $this }}')
                .section('biupi')
                .header('{{ $this }}')
                .header('{{ $this }}')
                .footer('biupi')
            )
        )
        .div(
            y().context()
            .attr('reu', true)
            .set('title', 'weeeeee')
            .text('{{ title }}')
        );

    for (var j = 0; j < 200; ++j)
    // t.p('fgfgfg');
        t.p('{{ world }}');



    test = {}

    test.string = function() {
        var time = new Date().getTime();

        // for (var i = 0; i < 1000; ++i)
        // console.log(
        t.toHTMLString()

        time = new Date().getTime() - time;
        console.log('string time : ', time);
        document.getElementById('res').innerHTML = time;
    };

    test.string2 = function() {

        var time = new Date().getTime();
        var promises = [];

        // for (var i = 0; i < 1000; ++i)
        promises.push(
            // console.log(
            t.toHTMLString()
        );

        Promise.all(promises)
            .then(function(res) {
                time = new Date().getTime() - time;
                console.log('string time : ', time);
                document.getElementById('res').innerHTML = time;
                // string();
            }).catch(function(e) {
                console.error(e);
                console.log(e.stack);
            });
    };
    //____________________________ TWO PASS


    test.twopass = function() {
        var time = new Date().getTime();
        // for (var i = 0; i < 1000; ++i)
        t.twopass()
        time = new Date().getTime() - time;
        console.log('twopass time : ', time);
        document.getElementById('res').innerHTML = time;
    };

    test.twopass2 = function() {
        var promises = [];
        var time = new Date().getTime();
        // for (var i = 0; i < 1000; ++i) {
        promises.push(
            // console.log(
            t.twopass()
        );
        // }
        Promise.all(promises)
            .then(function(res) {
                time = new Date().getTime() - time;
                console.log('twopass2 time : ', time);
                document.getElementById('res').innerHTML = time;
                // string();
            }).catch(function(e) {
                console.error(e);
                console.log(e.stack);
            });
    };
    //____________________________________________________________________________________ DOM



    test.dom = function() {
        document.getElementById('app').innerHTML = '';
        var ctx = new y.Context();
        var time = new Date().getTime();

        // for (var i = 0; i < 100; ++i)
        // console.log(
        t.toContainer(ctx).mount('#app'); //.toString()
        // )
        time = new Date().getTime() - time;

        ctx.set('title', time);
        // document.getElementById('app').innerHTML = time;
    }






    // string();
    // string2();
    // test.twopass();
    // twopass2();
    test.dom();
    </script>
</body>

</html>
